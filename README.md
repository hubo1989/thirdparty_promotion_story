# 联合营销平台三方营销管理-云数汇接入项目

## 项目概述

本项目旨在构建一个完整的多渠道优惠券营销管理平台，通过接入云数汇第三方优惠券服务商，为合作银行提供统一的优惠券发放服务。项目包含三个核心组成部分：云数汇API接入层、主题活动管理系统和活动优惠券管理系统，形成完整的营销活动管理闭环。

### 核心价值

- **降低接入成本**：银行无需直接对接云数汇，通过标准化接口快速接入
- **统一管理平台**：提供完整的活动管理和数据分析能力
- **扩展性保障**：中间层设计支持后续接入多个上游发券通道
- **数据安全可控**：完整的权限控制和数据隔离机制

## 文档结构

### 📋 需求文档

- **[index.html](index.html)** - 联合营销平台三方营销管理-云数汇接入需求文档（主文档）
- **[activity_story.html](activity_story.html)** - 主题活动管理系统需求文档
- **[promotion_story.html](promotion_story.html)** - 活动优惠券管理系统需求文档

### 🎨 功能原型

- **[activity_prototype.html](activity_prototype.html)** - 主题活动管理功能原型
- **[promotion_prototype.html](promotion_prototype.html)** - 活动优惠券管理功能原型

### 📖 技术文档

- **[api/接口文档.md](api/接口文档.md)** - 云数汇API接口技术规范

### 🖼️ 预览图片

- **[image/activity_preview.png](image/activity_preview.png)** - 主题活动管理系统预览图
- **[image/promotion_preview.png](image/promotion_preview.png)** - 活动优惠券管理系统预览图

## 系统架构

### 整体架构概览

```
┌─────────────────────────────────────────────────────────────┐
│                    联合营销平台                              │
├─────────────────────┬───────────────────────────────────────┤
│   主题活动管理系统    │        活动优惠券管理系统              │
│                    │                                      │
│ • 活动策划配置       │ • 多渠道优惠券活动管理                 │
│ • 转盘抽奖设计       │ • 微信/支付宝/银联                    │
│ • 奖品池管理         │ • 发放监控与核销管理                   │
│ • 数据统计分析       │ • 数据分析与ROI统计                   │
└─────────────────────┴───────────────────────────────────────┘
                              │
                    ┌─────────────────┐
                    │  云数汇接入层    │
                    │                │
                    │ • API封装      │
                    │ • 回调处理      │
                    │ • 数据同步      │
                    └─────────────────┘
                              │
                    ┌─────────────────┐
                    │   云数汇平台     │
                    │                │
                    │ • 优惠券发放    │
                    │ • 核销通知      │
                    │ • 数据查询      │
                    └─────────────────┘
```

### 系统组成

- **主题活动管理系统**：负责营销活动的策划、配置和管理，包含转盘抽奖等互动功能
- **活动优惠券管理系统**：专门管理多渠道优惠券活动（微信、支付宝、银联），与主题活动关联
- **云数汇接入层**：封装云数汇API，提供统一的优惠券发放服务接口
- **联合营销平台**：为运营人员提供统一的管理界面和数据查询功能

## 核心功能

### 1. 云数汇API接入服务

- **获取OpenID**：H5页面获取用户微信OpenID
- **优惠券发放**：调用云数汇API发放优惠券
- **核销回调**：处理优惠券核销通知
- **数据查询**：查询发放结果和核销状态

### 2. 主题活动管理

- **活动策划**：创建和配置营销主题活动
- **互动设计**：配置转盘抽奖、积分兑换等玩法
- **奖品管理**：设置活动奖品池和发放规则
- **状态管理**：支持活动的启动、暂停、恢复和结束
- **数据统计**：提供活动参与度、转化率等核心指标

### 3. 活动优惠券管理

- **多渠道支持**：支持微信、支付宝、银联优惠券活动
- **活动关联**：与主题活动建立关联关系
- **券种管理**：配置不同类型优惠券和使用条件
- **发放监控**：实时监控优惠券发放状态
- **核销管理**：管理优惠券核销流程和数据统计

### 4. 数据管理与分析

- **发放统计**：按活动编码统计发放成功数量
- **核销统计**：统计核销成功数量和核销率
- **明细记录**：详细的发放和核销记录管理
- **权限隔离**：基于银行机构的数据权限控制
- **操作审计**：完整的操作日志记录

## 业务流程

### 完整业务流程

```
用户参与 → 获取OpenID → 发放优惠券 → 核销回调 → 数据统计
    ↓           ↓            ↓           ↓          ↓
  H5页面    微信授权      云数汇API    回调通知   联合营销平台
```

### 详细流程步骤

**第一阶段：获取用户OpenID**

1. H5页面跳转到云数汇授权页面
2. 用户完成微信授权
3. 回调返回OpenID到银行系统

**第二阶段：优惠券发放**
4. 银行系统调用发券接口
5. 系统调用云数汇API
6. 云数汇向微信平台发放优惠券
7. 同步保存发放记录

**第三阶段：核销与查询**
8. 用户使用优惠券触发核销回调
9. 系统更新核销状态
10. 提供数据查询和统计分析

## 技术规范

### 技术栈

- **前端**：HTML5、CSS3、JavaScript（ES6+）
- **后端**：Node.js、Express.js
- **数据库**：PostgreSQL
- **UI框架**：响应式设计、模态框组件
- **API规范**：RESTful API、JSON格式

### 接口规范

- **加密方式**：遵循云数汇标准加密规范
- **认证机制**：LKLAPI-SHA256withRSA签名认证
- **回调机制**：支持延时队列散列通知
- **数据格式**：统一JSON格式数据交换

### 性能要求

- **响应时间**：API接口响应时间 < 3秒
- **并发处理**：支持1000+并发用户访问
- **数据同步**：实时数据同步，延迟 < 5秒
- **可用性**：系统可用性 ≥ 99.5%

## 部署与维护

### 环境要求

- **浏览器支持**：Chrome 70+, Firefox 65+, Safari 12+, Edge 79+
- **网络要求**：可访问云数汇API服务
- **服务器要求**：Node.js 16+, PostgreSQL 12+

### 安全要求

- **数据加密**：敏感数据传输和存储加密
- **权限控制**：基于角色的访问控制（RBAC）
- **审计日志**：完整的操作审计和安全日志
- **数据隔离**：多租户数据隔离机制

## 更新日志

### v2.0.0 (2025-08-07)

- **🎯 重大更新**：重新组织项目架构和文档结构
- **📝 文档优化**：
  - 移除第7章"项目实施与部署"内容，精简文档结构
  - 重新撰写4.1节"云数汇API接口规范"，详细描述四个核心接口
  - 重新梳理所有章节和小标题序号，确保逻辑连续性
- **🔧 数据字典更新**：
  - 根据建表语句重新梳理主题活动表（bmt_theme_activity）数据字典
  - 更新字段名称、数据类型、长度和约束条件
  - 新增owner_id、rules、participation_limit、max_draws等字段
- **📋 技术规范完善**：
  - 新增api/接口文档.md技术接口说明
  - 更新预览图片资源
  - 完善README.md项目说明
    ---
