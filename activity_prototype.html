<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>活动原型</title>
    <style>
        .confirm-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .confirm-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .confirm-dialog {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            width: 400px;
            max-width: 90vw;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .confirm-overlay.show .confirm-dialog {
            transform: scale(1);
        }

        .confirm-overlay.show .confirm-dialog {
            transform: scale(1);
        }

        .confirm-header {
            padding: 20px 20px 10px;
            border-bottom: 1px solid #e6e6e6;
        }

        .confirm-header h4 {
            margin: 0;
            font-size: 16px;
            color: #303133;
        }

        .confirm-body {
            padding: 20px;
        }

        .confirm-body p {
            margin: 0;
            color: #606266;
            line-height: 1.5;
        }

        .confirm-footer {
            padding: 10px 20px 20px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn-confirm {
            padding: 10px 20px;
            border: 1px solid #f56c6c;
            background-color: #f56c6c;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-confirm:hover {
            background-color: #f78989;
        }

        .btn-cancel {
            padding: 10px 20px;
            border: 1px solid #dcdfe6;
            background-color: #f5f7fa;
            color: #606266;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-cancel:hover {
            background-color: #ecf5ff;
            color: #4a90e2;
            border-color: #4a90e2;
        }

        /* 数据表格 */
        .data-table {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            width: 100%;
            margin-top: 0;
        }

        .table-header {
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e8eaec;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-weight: 600;
            color: #2c3e50;
        }

        .table-container {
            overflow-x: auto;
            position: relative;
            width: 100%;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: auto;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
            border-right: 1px solid #f0f0f0;
            font-size: 14px;
            white-space: nowrap;
        }
        
        th:last-child, td:last-child {
            border-right: none;
        }

        th {
            background-color: #fafafa;
            font-weight: 600;
            color: #606266;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .checkbox-col {
            width: auto;
            min-width: 50px;
            text-align: center;
        }

        .action-col {
            width: auto;
            min-width: 160px;
            position: sticky;
            right: 0;
            background-color: #fafafa;
            z-index: 15;
            box-shadow: -2px 0 4px rgba(0,0,0,0.1);
        }

        tbody .action-col {
            background-color: white;
            z-index: 15;
        }

        .action-col::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 1px;
            background-color: #f0f0f0;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .action-link {
            color: #4a90e2;
            text-decoration: none;
            margin-right: 10px;
            font-size: 12px;
        }

        .action-link:hover {
            text-decoration: underline;
        }

        /* 分页 */
        .pagination {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: #fafafa;
        }

        .pagination-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .pagination-info {
            color: #606266;
            font-size: 14px;
        }

        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #606266;
            font-size: 14px;
        }

        .page-size-select {
            padding: 5px 8px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background-color: white;
            color: #606266;
            font-size: 14px;
            outline: none;
            cursor: pointer;
        }

        .pagination-controls {
            display: flex;
            gap: 5px;
        }

        .page-btn {
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            cursor: pointer;
            font-size: 14px;
            border-radius: 4px;
        }

        .page-btn:hover {
            background-color: #f5f7fa;
        }

        .page-btn.active {
            background-color: #4a90e2;
            color: white;
            border-color: #4a90e2;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .channel-tags {
            background-color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .channel-tags::before {
            content: '渠道：';
            color: #606266;
            font-size: 14px;
            margin-right: 5px;
        }

        .channel-tag {
            padding: 8px 16px;
            border: 1px solid #dcdfe6;
            border-radius: 20px;
            background-color: #f8f9fa;
            color: #606266;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            -webkit-user-select: none;
            user-select: none;
        }

        .channel-tag:hover {
            border-color: #4a90e2;
            color: #4a90e2;
        }

        .channel-tag.active {
            background-color: #4a90e2;
            border-color: #4a90e2;
            color: white;
        }

        /* 状态徽章 */
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-active {
            background-color: #f0f9ff;
            color: #67c23a;
        }

        .status-inactive {
            background-color: #fef0f0;
            color: #f56c6c;
        }

        .status-pending {
            background-color: #fdf6ec;
            color: #e6a23c;
        }

        .status-success {
            background: #f0f9ff;
            color: #1890ff;
        }

        .status-info {
            background: #e6f7ff;
            color: #1890ff;
        }

        .status-warning {
            background: #fff7e6;
            color: #fa8c16;
        }

        .status-danger {
            background: #fff2f0;
            color: #f5222d;
        }
        
        /* 页面整体布局样式 */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #f5f7fa;
            color: #303133;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            height: 60px;
            background-color: #4a90e2;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            gap: 10px;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background-color: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a90e2;
            font-weight: bold;
        }
        
        .nav-info {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }
        
        .breadcrumb {
            background-color: #e8f3ff;
            padding: 10px 20px;
            font-size: 14px;
            color: #4a90e2;
        }
        
        .breadcrumb a {
            color: #4a90e2;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .main-container {
            display: flex;
            min-height: calc(100vh - 100px);
        }
        
        .sidebar {
            width: 250px;
            min-width: 250px;
            max-width: 250px;
            background-color: white;
            border-right: 1px solid #e0e0e0;
            padding: 20px 0;
            flex-shrink: 0;
        }
        
        .menu-item {
            margin-bottom: 5px;
        }
        
        .menu-title {
            padding: 12px 20px;
            cursor: pointer;
            color: #606266;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .menu-title:hover {
            background-color: #f5f7fa;
            color: #4a90e2;
        }
        
        .menu-title.active {
            background-color: #ecf5ff;
            color: #4a90e2;
            font-weight: 500;
        }

        .menu-arrow {
            transition: transform 0.3s;
            font-size: 12px;
        }

        .menu-arrow.expanded {
            transform: rotate(90deg);
        }

        /* 标签页样式 */
        .tab-nav {
            display: flex;
            gap: 2px;
            margin-bottom: 20px;
        }

        .tab-nav .tab-item {
            padding: 10px 17px;
            background-color: white;
            border: 1px solid #dcdfe6;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 4px 4px 0 0;
            color: #4a90e2;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 150px !important;
            font-size: 14px;
            font-weight: 400;
            line-height: 1.4;
            text-align: center;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .tab-nav .tab-item.active {
            background-color: white;
            color: #4a90e2;
            border-color: #4a90e2;
            border-bottom-color: white;
            position: relative;
            z-index: 1;
            font-weight: 500;
        }

        .tab-nav .tab-item:hover:not(.active) {
            background-color: #f8f9fa;
            color: #4a90e2;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(74, 144, 226, 0.2);
        }

        /* 标签栏响应式 */
        @media (max-width: 768px) {
            .tab-nav {
                gap: 1px;
                margin-bottom: 15px;
            }
            
            .tab-nav .tab-item {
                padding: 8px 13px;
                width: 135px !important;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .tab-nav {
                flex-direction: column;
                gap: 0;
            }
            
            .tab-nav .tab-item {
                border-radius: 4px;
                margin-bottom: 2px;
                width: 100%;
                padding: 10px 17px;
            }
            
            .tab-nav .tab-item.active {
                border-bottom-color: #4a90e2;
            }
        }
        
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: #f8f9fa;
        }
        
        .submenu.show {
            max-height: 300px;
        }
        
        .submenu-item {
            padding: 10px 20px 10px 50px;
            color: #606266;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submenu-item:hover {
            background-color: #ecf5ff;
            color: #4a90e2;
        }

        .submenu-item.active {
            background-color: #4a90e2;
            color: white;
        }
        
        .content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .content-header {
            margin-bottom: 20px;
        }
        
        .content-title {
            margin: 0;
            font-size: 24px;
            color: #303133;
            font-weight: 500;
        }
        
        .query-form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px !important;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .form-row:first-child {
            gap: 15px;
        }
        
        .form-row:first-child .form-group {
            min-width: 260px;
            flex: 1 1 260px;
        }
        
        .form-row:first-child .form-group.dropdown-group {
            min-width: 280px;
            flex: 1 1 280px;
        }
        
        .form-row:last-child {
            margin-bottom: 0;
        }
        
        .form-group {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 0 0 auto;
            min-width: 280px;
        }
        
        .form-group.dropdown-group {
            min-width: 300px;
        }
        
        .form-group label {
            min-width: 120px;
            color: #606266;
            font-size: 14px;
            white-space: nowrap;
            text-align: right;
            padding-right: 8px;
        }
        
        .form-group input,
        .form-group select {
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            min-width: 150px;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        /* 响应式布局 */
        @media (max-width: 1400px) {
            .form-row {
                gap: 15px;
            }
            .form-group {
                min-width: 300px;
            }
        }

        @media (max-width: 1024px) {
            .form-row {
                gap: 12px;
            }
            .form-group {
                min-width: 100%;
                flex: 1 1 100%;
            }
            .form-group label {
                min-width: 100px;
                text-align: left;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                gap: 10px;
                flex-direction: column;
            }
            .form-group {
                min-width: 100%;
                flex: 1 1 100%;
                gap: 4px;
            }
            .form-group label {
                min-width: 80px;
                text-align: left;
                padding-right: 4px;
            }
            .form-group input,
            .form-group select {
                min-width: 180px;
                flex: 1;
            }
        }
        
        .date-range {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .date-range input {
            flex: 1;
            min-width: 120px;
        }
        
        .date-range span {
            color: #606266;
            font-size: 14px;
            white-space: nowrap;
        }
        
        /* 下拉选择器样式 */
        .dropdown-group {
            position: relative;
        }
        
        .dropdown-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .dropdown-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: white;
            border: 1px solid #dcdfe6;
            border-top: none;
            border-radius: 0 0 4px 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .dropdown-list.show {
            display: block;
        }
        
        .dropdown-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            color: #606266;
            border-bottom: 1px solid #f5f7fa;
            transition: background-color 0.2s;
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
        
        .dropdown-item:hover {
            background-color: #f5f7fa;
            color: #409eff;
        }
        
        .dropdown-item.selected {
            background-color: #409eff;
            color: white;
        }
        
        .dropdown-group input {
            border-radius: 4px;
        }
        
        .dropdown-group input:focus {
            border-radius: 4px 4px 0 0;
        }
        
        .dropdown-container input {
            width: 100%;
        }
        
        /* 确保下拉列表在输入框下方正确显示 */
        .dropdown-group:focus-within .dropdown-list.show {
            display: block;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #4a90e2;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #5ba0f2;
        }
        
        .btn-secondary {
            background-color: #67c23a;
            color: white;
            border: 1px solid #67c23a;
        }
        
        .btn-secondary:hover {
            background-color: #85ce61;
            border-color: #85ce61;
        }
        
        .btn-default {
            background-color: #f5f7fa;
            color: #606266;
            border: 1px solid #dcdfe6;
        }
        
        .btn-default:hover {
            background-color: #ecf5ff;
            color: #4a90e2;
            border-color: #4a90e2;
        }
        
        .btn-gray {
            background-color: #909399;
            color: white;
            border: 1px solid #909399;
        }
        
        .btn-gray:hover {
            background-color: #82848a;
            border-color: #82848a;
        }
        
        .table-actions {
            display: flex;
            gap: 10px;
        }
        
        /* 二维码信息样式 */
        .qrcode-info {
            margin: 15px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
        
        .qrcode-info-item {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .qrcode-info-item:last-child {
            margin-bottom: 0;
        }
        
        .info-label {
            font-weight: 500;
            color: #606266;
            margin-right: 10px;
            min-width: 120px;
            display: inline-block;
        }
        
        .info-value {
            color: #303133;
            word-break: break-all;
        }
        
        /* 二维码操作按钮样式 */
        .qrcode-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        /* 新增右侧弹出模态框样式 */
        .slide-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 720px;
            height: 100%;
            background-color: white;
            box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
            z-index: 1003;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .slide-modal.show {
            transform: translateX(0);
        }

        .slide-modal-header {
            padding: 20px;
            border-bottom: 1px solid #e8eaec;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .slide-modal-header h3 {
            margin: 0;
            font-size: 18px;
            color: #303133;
        }

        .slide-modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #909399;
        }

        .slide-modal-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .slide-modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #e8eaec;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }



        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #606266;
            font-size: 14px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .form-group input:disabled,
        .form-group select:disabled {
            background-color: #f5f7fa;
            color: #909399;
            cursor: not-allowed;
        }

        /* 选择器组件样式 */
        .selector-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .selected-institutions,
        .selected-banks {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: flex-start;
            min-height: 40px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            padding: 8px;
            background-color: #f9f9f9;
        }

        .selected-tag {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            background-color: #e8f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 16px;
            font-size: 12px;
            color: #4a90e2;
            gap: 6px;
            max-width: 200px;
        }

        .selected-tag.bank-tag {
            background-color: #f0f9ff;
            border-color: #b3e0ff;
            color: #1890ff;
        }

        .tag-text {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .tag-remove {
            cursor: pointer;
            color: #999;
            font-weight: bold;
            font-size: 14px;
            line-height: 1;
            padding: 2px;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tag-remove:hover {
            background-color: rgba(245, 108, 108, 0.1);
            color: #f56c6c;
        }

        .placeholder-text {
            color: #999;
            font-size: 14px;
            font-style: italic;
        }

        .selector-select {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }

        .selector-btn {
            padding: 8px 16px;
            background-color: #67c23a;
            color: white;
            border: 1px solid #67c23a;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .selector-btn:hover {
            background-color: #85ce61;
            border-color: #85ce61;
        }

        /* 模态框优化样式 */
        .slide-modal-body {
            max-height: calc(100vh - 140px);
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group:last-child {
            margin-bottom: 20px;
        }

        /* 选择器动画效果 */
        .selected-tag {
            animation: tagAppear 0.3s ease-out;
            transition: all 0.2s ease;
        }

        .selected-tag:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(74, 144, 226, 0.3);
        }

        @keyframes tagAppear {
            from {
                opacity: 0;
                transform: scale(0.8) translateY(-10px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .selector-btn:active {
            transform: translateY(1px);
        }

        /* 空状态样式优化 */
        .placeholder-text {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 38px;
            border: 2px dashed #e1e8ed;
            border-radius: 4px;
            background-color: #fafafa;
            transition: all 0.3s ease;
        }

        .placeholder-text:hover {
            border-color: #b3d9ff;
            background-color: #f7fbff;
        }

        /* 表单验证提示 */
        .form-group.error .selector-select,
        .form-group.error .selected-institutions,
        .form-group.error .selected-banks {
            border-color: #f56c6c;
            box-shadow: 0 0 0 2px rgba(245, 108, 108, 0.2);
        }

        .error-message {
            color: #f56c6c;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .form-group.error .error-message {
            display: block;
        }

        /* 模态框内筛选区域优化样式 */
        .slide-modal .query-form {
            margin-bottom: 25px;
            padding: 24px;
            background-color: #fafbfc;
            border: 1px solid #e4e7ed;
        }

        .slide-modal .query-form .form-row {
            display: flex;
            gap: 32px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: nowrap;
        }

        .slide-modal .query-form .form-group {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 12px;
            flex: 1;
            min-width: 0;
            margin-bottom: 0;
        }

        .slide-modal .query-form .form-group label {
            font-weight: 500;
            color: #303133;
            font-size: 14px;
            text-align: right;
            min-width: 80px;
            padding-right: 8px;
            white-space: nowrap;
            margin-bottom: 0;
            flex-shrink: 0;
        }

        .slide-modal .query-form .form-group input,
        .slide-modal .query-form .form-group select {
            flex: 1;
            min-width: 180px;
            padding: 10px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 6px;
            font-size: 14px;
            background-color: white;
            transition: all 0.3s;
            box-sizing: border-box;
        }

        .slide-modal .query-form .form-group input:focus,
        .slide-modal .query-form .form-group select:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .slide-modal .query-form .form-group input::placeholder {
            color: #c0c4cc;
            font-size: 14px;
        }

        .slide-modal .query-form .form-actions {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e4e7ed;
        }

        .slide-modal .query-form .form-actions .btn {
            min-width: 88px;
            padding: 10px 24px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            transition: all 0.3s;
        }

        .slide-modal .query-form .form-actions .btn-default {
            background-color: white;
            color: #606266;
            border: 1px solid #dcdfe6;
        }

        .slide-modal .query-form .form-actions .btn-default:hover {
            background-color: #f5f7fa;
            border-color: #c0c4cc;
            color: #409eff;
        }

        .slide-modal .query-form .form-actions .btn-primary {
            background-color: #409eff;
            color: white;
            border: 1px solid #409eff;
        }

        .slide-modal .query-form .form-actions .btn-primary:hover {
            background-color: #66b1ff;
            border-color: #66b1ff;
        }

        /* 响应式优化 */
        @media (max-width: 1000px) {
            .slide-modal .query-form .form-row {
                gap: 24px;
            }
            
            .slide-modal .query-form .form-group {
                min-width: 300px;
                margin-bottom: 0;
            }
            
            .slide-modal .query-form .form-group input,
            .slide-modal .query-form .form-group select {
                min-width: 160px;
            }
        }

        @media (max-width: 800px) {
            .slide-modal .query-form .form-row {
                flex-direction: column;
                gap: 20px;
                align-items: stretch;
            }
            
            .slide-modal .query-form .form-group {
                flex: none;
                width: 100%;
                min-width: auto;
                margin-bottom: 0;
            }
            
            .slide-modal .query-form .form-group label {
                min-width: 100px;
                text-align: left;
            }
        }

        @media (max-width: 600px) {
            .slide-modal .query-form {
                padding: 20px;
            }
            
            .slide-modal .query-form .form-group {
                gap: 8px;
                margin-bottom: 0;
            }
            
            .slide-modal .query-form .form-group label {
                min-width: 80px;
                font-size: 13px;
            }
            
            .slide-modal .query-form .form-group input,
            .slide-modal .query-form .form-group select {
                min-width: 140px;
                padding: 8px 10px;
                font-size: 13px;
            }
            
            .slide-modal .query-form .form-actions {
                flex-direction: column;
                gap: 12px;
            }
            
            .slide-modal .query-form .form-actions .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* 模态框操作区域优化样式 */
        .slide-modal .table-actions {
            margin: 25px 0;
            padding: 20px 24px;
            background-color: white;
            border: 1px solid #e4e7ed;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .slide-modal .table-actions-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .slide-modal .table-actions-left label {
            font-weight: 500;
            color: #303133;
            font-size: 14px;
            white-space: nowrap;
            margin-right: 4px;
        }

        .slide-modal .table-actions-left select {
            min-width: 200px;
            padding: 10px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 6px;
            font-size: 14px;
            background-color: white;
            transition: all 0.3s;
        }

        .slide-modal .table-actions-left select:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .slide-modal .table-actions-right {
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }

        .slide-modal .table-actions .btn {
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .slide-modal .table-actions .btn-secondary {
            background-color: #67c23a;
            color: white;
            border: 1px solid #67c23a;
        }

        .slide-modal .table-actions .btn-secondary:hover {
            background-color: #85ce61;
            border-color: #85ce61;
        }

        .slide-modal .table-actions .btn-danger {
            background-color: #f56c6c;
            color: white;
            border: 1px solid #f56c6c;
        }

        .slide-modal .table-actions .btn-danger:hover {
            background-color: #f78989;
            border-color: #f78989;
        }

        .slide-modal .table-actions .btn-primary {
            background-color: #409eff;
            color: white;
            border: 1px solid #409eff;
        }

        .slide-modal .table-actions .btn-primary:hover {
            background-color: #66b1ff;
            border-color: #66b1ff;
        }

        /* 响应式操作区域 */
        @media (max-width: 900px) {
            .slide-modal .table-actions {
                flex-direction: column;
                align-items: stretch;
                gap: 16px;
            }
            
            .slide-modal .table-actions-left {
                justify-content: flex-start;
                flex-wrap: wrap;
                gap: 12px;
            }
            
            .slide-modal .table-actions-left select {
                min-width: 160px;
                flex: 1;
            }
            
            .slide-modal .table-actions-right {
                justify-content: center;
            }
        }

        @media (max-width: 600px) {
            .slide-modal .table-actions {
                padding: 16px 20px;
            }
            
            .slide-modal .table-actions-left {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .slide-modal .table-actions-left label {
                text-align: left;
            }
            
            .slide-modal .table-actions-left select {
                width: 100%;
                min-width: auto;
            }
            
            .slide-modal .table-actions-right {
                flex-direction: column;
                gap: 8px;
            }
            
            .slide-modal .table-actions .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* 模态框数据表格优化样式 */
        .slide-modal .data-table {
            background-color: white;
            border: 1px solid #e4e7ed;
            border-radius: 8px;
            overflow: hidden;
        }

        .slide-modal .data-table .table-container {
            overflow-x: auto;
            position: relative;
        }

        .slide-modal .data-table table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            font-size: 14px;
        }

        .slide-modal .data-table thead {
            background-color: #fafbfc;
        }

        .slide-modal .data-table th {
            padding: 16px 12px;
            text-align: left;
            font-weight: 500;
            color: #303133;
            border-bottom: 1px solid #e4e7ed;
            white-space: nowrap;
        }

        .slide-modal .data-table td {
            padding: 14px 12px;
            color: #606266;
            border-bottom: 1px solid #f5f7fa;
            vertical-align: middle;
        }

        .slide-modal .data-table tbody tr:hover {
            background-color: #f9f9f9;
        }

        .slide-modal .data-table tbody tr:last-child td {
            border-bottom: none;
        }

        .slide-modal .data-table .checkbox-col {
            width: 50px;
            text-align: center;
            padding: 12px 8px;
        }

        .slide-modal .data-table .action-col {
            width: 80px;
            text-align: center;
            position: sticky;
            right: 0;
            background-color: white;
            z-index: 5;
            box-shadow: -2px 0 4px rgba(0,0,0,0.1);
        }

        .slide-modal .data-table thead .action-col {
            background-color: #fafbfc;
            z-index: 10;
        }

        .slide-modal .data-table tbody tr:hover .action-col {
            background-color: #f9f9f9;
        }

        .slide-modal .data-table .action-link {
            color: #f56c6c;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }

        .slide-modal .data-table .action-link:hover {
            color: #f78989;
            text-decoration: underline;
        }

        .slide-modal .data-table input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        /* 模态框分页样式优化 */
        .slide-modal .pagination {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fafbfc;
            border-top: 1px solid #e4e7ed;
            font-size: 14px;
        }

        .slide-modal .pagination-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .slide-modal .pagination-info {
            color: #606266;
        }

        .slide-modal .page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #606266;
        }

        .slide-modal .page-size-select {
            padding: 4px 8px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
        }

        .slide-modal .pagination-controls {
            display: flex;
            gap: 4px;
        }

        .slide-modal .page-btn {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            color: #606266;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .slide-modal .page-btn:hover:not([disabled]) {
            background-color: #f5f7fa;
            border-color: #c0c4cc;
        }

        .slide-modal .page-btn.active {
            background-color: #409eff;
            border-color: #409eff;
            color: white;
        }

        .slide-modal .page-btn[disabled] {
            color: #c0c4cc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* 响应式表格 */
        @media (max-width: 600px) {
            .slide-modal .pagination {
                flex-direction: column;
                gap: 12px;
                padding: 16px;
            }
            
            .slide-modal .pagination-left {
                flex-direction: column;
                gap: 8px;
            }
        }
        
        /* 查看活动详情模态框样式 */
        .tab-container {
            width: 100%;
        }
        
        .tab-header {
            display: flex;
            border-bottom: 1px solid #e8eaec;
            margin-bottom: 20px;
        }
        
        .slide-modal .tab-header {
            display: flex;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e4e7ed;
            margin-bottom: 20px;
            padding: 0;
            border-radius: 6px 6px 0 0;
            overflow: hidden;
        }
        
        .slide-modal .tab-item {
            padding: 10px 20px;
            cursor: pointer;
            color: #606266;
            font-size: 14px;
            border-bottom: 2px solid transparent;
            background-color: #f8f9fa;
            border: 1px solid #e4e7ed;
            border-radius: 6px 6px 0 0;
            margin-right: 2px;
            transition: all 0.3s;
        }
        
        .slide-modal .tab-item:hover:not(.active) {
            color: #409eff;
            background-color: #ecf5ff;
            border-color: #b3d8ff;
        }
        
        .slide-modal .tab-item.active {
            color: #409eff;
            background-color: white;
            border-bottom: 2px solid #409eff;
            border-color: #409eff;
            font-weight: 500;
        }
        
        .tab-content {
            width: 100%;
        }
        
        .tab-pane {
            display: none;
        }
        
        .tab-pane.active {
            display: block;
        }
        
        /* 批次数据样式 */
        .batch-data-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .batch-item {
            border: 1px solid #e8eaec;
            border-radius: 4px;
            padding: 15px;
        }
        
        .batch-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .batch-title {
            font-weight: bold;
            font-size: 16px;
            color: #303133;
        }
        
        .batch-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        .batch-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
        }
        
        .detail-label {
            color: #606266;
        }
        
        .detail-value {
            color: #303133;
            font-weight: 500;
        }
        
        /* 商户样式 */
        .merchant-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .merchant-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border: 1px solid #e8eaec;
            border-radius: 4px;
        }
        
        .merchant-name {
            font-weight: 500;
            color: #303133;
        }
        
        .merchant-id {
            color: #606266;
            font-size: 12px;
        }
        
        .merchant-status {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 12px;
        }
        
        /* 二维码/链接样式 */
        .qrcode-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .qrcode-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .qrcode-title {
            font-weight: 500;
            color: #303133;
        }
        
        .qrcode-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .qrcode-link a {
            color: #409eff;
            text-decoration: none;
        }
        
        .qrcode-link a:hover {
            text-decoration: underline;
        }
        
        /* 配置转盘样式 */
        .wheel-config-container {
            padding: 15px 0;
        }
        
        .wheel-config-table {
            margin-bottom: 15px;
            overflow-x: auto;
        }
        
        .config-table {
            width: auto;
            border-collapse: collapse;
            border: 1px solid #e8eaec;
            table-layout: auto;
            max-width: none;
        }
        
        .table-wrapper {
            display: flex;
            width: 100%;
            max-width: 100%;
            border: 1px solid #e8eaec;
            border-radius: 4px;
            overflow: visible; /* 改为visible以确保操作列按钮可见 */
        }
        
        .scrollable-table {
            flex: 1;
            overflow-x: auto;
            border-right: 1px solid #e8eaec;
        }
        

        
        .main-table {
            border: none;
            width: 100%;
            table-layout: fixed;
        }
        
        .main-table th:nth-child(1) { width: 60px; }
        .main-table th:nth-child(2) { width: auto; max-width: 200px; }
        .main-table th:nth-child(3) { width: 80px; }
        .main-table th:nth-child(4) { width: 80px; }
        .main-table th:nth-child(5) { width: 120px; }
        
        .main-table tr {
            height: 50px;
        }
        
        .main-table th,
        .main-table td {
            vertical-align: middle;
            border-bottom: 1px solid #e8eaec;
            height: 50px;
            padding: 12px 6px;
        }
        
        .main-table td:nth-child(5) {
            text-align: center;
            padding: 8px 6px;
        }
        

        
        .scrollable-table::-webkit-scrollbar {
            height: 6px;
        }
        
        .scrollable-table::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .scrollable-table::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        
        .scrollable-table::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        .wheel-config-table {
            width: auto;
            margin-top: 5px; /* 为内容卡片与表格之间增加5px间距 */
        }
        
        .config-table th,
        .config-table td {
            padding: 12px 6px;
            text-align: left;
            border-bottom: 1px solid #e8eaec;
            border-right: 1px solid #e8eaec;
            vertical-align: middle;
            overflow: visible; /* 改为visible以确保内容可见 */
            height: 50px;
        }
        
        .config-table td:nth-child(1),
        .config-table td:nth-child(3),
        .config-table td:nth-child(4),
        .config-table td:nth-child(5) {
            text-align: center;
            vertical-align: middle;
        }
        
        .config-table th:nth-child(1),
        .config-table th:nth-child(3),
        .config-table th:nth-child(4) {
            text-align: center;
            vertical-align: middle;
        }
        
        .config-table td:nth-child(2) {
            padding: 5px;
            width: 240px;
            min-width: 150px;
            max-width: 200px; /* 增加内容列的最大宽度 */
        }
        
        .config-table th:nth-child(1) { width: 40px; min-width: 40px; }  /* 顺序列 */
        .config-table th:nth-child(2) { width: 240px; min-width: 240px; max-width: 240px; white-space: normal; }  /* 内容列 */
        .config-table th:nth-child(3) { width: 60px; min-width: 60px; }  /* 颜色列 */
        .config-table th:nth-child(4) { width: 60px; min-width: 60px; }  /* 权重列 */
        .config-table th:nth-child(5) { width: 40px; min-width: 40px; }  /* 操作列 */
        
        /* 操作列固定定位样式 */
        .config-table th:nth-child(5),
        .config-table td:nth-child(5) {
            position: sticky;
            right: 0;
            background-color: #fff;
            z-index: 10;
            border-left: 1px solid #e8eaec;
            box-shadow: -2px 0 4px rgba(0, 0, 0, 0.1);
        }
        
        .config-table th:nth-child(5) {
            background-color: #f5f7fa;
        }
        
        .config-table tbody tr:hover td:nth-child(5) {
            background-color: #f5f7fa;
        }
        
        .config-table th {
            background-color: #f5f7fa;
            font-weight: 500;
            color: #303133;
            font-size: 14px;
        }
        
        .config-table th:last-child,
        .config-table td:last-child {
            border-right: none;
        }
        
        .config-table tbody tr:last-child td {
            border-bottom: none;
        }
        
        .config-table tbody tr:hover {
            background-color: #f5f7fa;
        }
        
        .order-input {
            width: 25px;
            padding: 4px 6px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            text-align: center;
            font-size: 12px;
        }
        
        .content-input {
            min-width: 220px;
            width: 220px;
            max-width: 220px; /* 与内容列保持一致 */
            padding: 6px 8px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            resize: vertical;
            min-height: 40px;
            font-family: inherit;
            line-height: 1.3;
            font-size: 12px;
            box-sizing: border-box;
            margin: 5px 0;
        }
        
        .content-input:focus {
            outline: none;
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        /* 活动内容卡片样式 */
        .activity-content-card {
            border-radius: 8px;
            padding: 8px 10px;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            width: auto;
            min-width: 220px;
            max-width: 280px; /* 与内容列保持一致 */
            display: inline-flex;
            justify-content: space-between;
            align-items: flex-start;
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            margin: 5px auto; /* 居中对齐 */
        }
        
        /* 确保所有内容卡片具有相同宽度并居中对齐 */
        .config-table td:nth-child(2) {
            text-align: center;
        }
        
        .config-table td:nth-child(2) .activity-content-card {
            width: auto !important;
            min-width: 220px !important;
            max-width: 320px !important;
            margin: 5px auto !important;
        }
        
        .activity-content-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .activity-content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 100%);
            pointer-events: none;
        }
        
        .activity-content-card .left-content {
            flex: 1;
            min-width: 0;
            word-break: break-word;
        }
        .activity-content-card .right-content {
            text-align: right;
            margin-left: 12px;
            font-size: 10px;
            opacity: 0.9;
            flex-shrink: 0;
        }
        .activity-id {
            font-size: 11px;
            opacity: 0.8;
            margin-bottom: 2px;
        }
        .activity-title {
            font-weight: 600;
            font-size: 12px;
            line-height: 1.2;
        }
        .activity-start-time,
        .activity-end-time {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 1px;
        }
        

        
        .color-display {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid #fff;
            cursor: pointer;
            display: inline-block;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        
        .color-display:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .weight-input {
            width: 30px;
            padding: 4px 6px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            text-align: center;
            font-size: 12px;
        }
        

        
        .wheel-config-actions {
            text-align: left;
        }
        
        .btn-add-config {
            background-color: #409eff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .btn-add-config:hover {
            background-color: #66b1ff;
        }
        
        /* 删除按钮样式 */
        .btn-delete {
            background-color: #f56c6c;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s;
        }
        
        .btn-delete:hover {
            background-color: #f78989;
        }
        
        .btn-delete.disabled {
            background-color: #c0c4cc;
            color: #909399;
            cursor: not-allowed;
        }
        
        .btn-delete.disabled:hover {
            background-color: #c0c4cc;
        }
        
        .action-cell {
            text-align: center;
            padding: 8px 6px;
        }
        
        /* 颜色选择器样式 */
        .color-picker-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .color-picker-panel {
            background-color: white;
            border-radius: 8px;
            width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .color-picker-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #e8eaec;
        }
        
        .color-picker-header h4 {
            margin: 0;
            color: #303133;
        }
        
        .color-picker-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #909399;
        }
        
        .color-picker-close:hover {
            color: #606266;
        }
        
        .color-picker-body {
            padding: 20px;
        }
        
        .color-palette {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .color-item {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border-color 0.2s;
        }
        
        .color-item:hover {
            border-color: #409eff;
        }
        
        .color-item.selected {
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .custom-color-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .custom-color-input label {
            color: #606266;
            font-size: 14px;
        }
        
        .custom-color-input input[type="color"] {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .color-picker-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding: 16px 20px;
            border-top: 1px solid #e8eaec;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-icon">L</div>
            <span>联合营销平台</span>
        </div>
        <div class="nav-info">
            <span>三方营销配置 / 主题活动管理</span>
            <span>管理员</span>
        </div>
    </div>
    
    <div class="breadcrumb">
        <a href="#">三方营销配置</a> / 主题活动管理
    </div>
    
    <div class="main-container">
        <div class="sidebar">
            <div class="menu-item">
                <div class="menu-title">
                    <span>运营中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>数据中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>配置中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>下载中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>营销中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title active" onclick="toggleSubmenu(this)">
                    <span>三方营销配置</span>
                    <span class="menu-arrow expanded">▶</span>
                </div>
                <div class="submenu show">
                    <div class="submenu-item active" onclick="navigateToPage('activity_prototype.html')">主题活动管理</div>
                    <div class="submenu-item" onclick="navigateToPage('promotion_prototype.html')">活动优惠券管理</div>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>机构管理</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>对账中心</span>
                </div>
            </div>
            <div class="menu-item">
                <div class="menu-title">
                    <span>银行服务管理</span>
                </div>
            </div>
        </div>
        
        <div class="content">
            <div class="content-header">
                <h1 class="content-title">主题活动管理</h1>
            </div>

            <!-- 标签页 -->
            <style>
                /* 强制标签宽度 - 最高优先级 */
                .tab-nav .tab-item {
                    width: 150px !important;
                    min-width: 150px !important;
                    max-width: 150px !important;
                    flex: none !important;
                    flex-shrink: 0 !important;
                    flex-grow: 0 !important;
                    box-sizing: border-box !important;
                }
            </style>
            <div class="tab-nav">
                <div class="tab-item active" onclick="navigateToPage('activity_prototype.html')" style="width: 150px !important; min-width: 150px !important; max-width: 150px !important; flex: none !important;">
                    <span>主题活动管理</span>
                </div>
                <div class="tab-item" onclick="navigateToPage('promotion_prototype.html')" style="width: 150px !important; min-width: 150px !important; max-width: 150px !important; flex: none !important;">
                    <span>活动优惠券管理</span>
                </div>
            </div>
            
            <div class="channel-tags">
                <div class="channel-tag active">云数汇</div>
            </div>
            
            <div class="query-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="activityId">主题活动ID:</label>
                        <input type="text" id="activityId" placeholder="请输入">
                    </div>
                    <div class="form-group">
                        <label for="activityName">主题名称:</label>
                        <input type="text" id="activityName" placeholder="请输入">
                    </div>
                    <div class="form-group">
                        <label for="headerNumber">头寸编号:</label>
                        <select id="headerNumber">
                            <option value="">请选择头寸编号</option>
                            <option value="02001018113100000000000">02001018113100000000000</option>
                            <option value="02001018113100000000001">02001018113100000000001</option>
                            <option value="02001018113100000000002">02001018113100000000002</option>
                            <option value="02001018113100000000003">02001018113100000000003</option>
                            <option value="02001018113100000000004">02001018113100000000004</option>
                            <option value="02001018113100000000005">02001018113100000000005</option>
                            <option value="02001018113100000000006">02001018113100000000006</option>
                            <option value="02001018113100000000007">02001018113100000000007</option>
                            <option value="02001018113100000000008">02001018113100000000008</option>
                            <option value="02001018113100000000009">02001018113100000000009</option>
                        </select>
                    </div>
                    <div class="form-group dropdown-group">
                        <label for="institution">报名机构:</label>
                        <div class="dropdown-container">
                            <input type="text" id="institution" placeholder="请输入机构名称" autocomplete="off" oninput="filterInstitutions(this.value)" onfocus="showInstitutionDropdown()" onblur="hideInstitutionDropdown()">
                            <div class="dropdown-list" id="institutionDropdown">
                                <div class="dropdown-item" onclick="selectInstitution('华夏银行')">华夏银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('建设银行')">建设银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('工商银行')">工商银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('农业银行')">农业银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('中国银行')">中国银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('交通银行')">交通银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('招商银行')">招商银行</div>
                                <div class="dropdown-item" onclick="selectInstitution('浦发银行')">浦发银行</div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group dropdown-group">
                        <label for="associatedBank">关联银行:</label>
                        <div class="dropdown-container">
                            <input type="text" id="associatedBank" placeholder="请输入银行名称" autocomplete="off" oninput="filterBanks(this.value)" onfocus="showBankDropdown()" onblur="hideBankDropdown()">
                            <div class="dropdown-list" id="bankDropdown">
                                <div class="dropdown-item" onclick="selectBank('中国工商银行')">中国工商银行</div>
                                <div class="dropdown-item" onclick="selectBank('中国建设银行')">中国建设银行</div>
                                <div class="dropdown-item" onclick="selectBank('中国农业银行')">中国农业银行</div>
                                <div class="dropdown-item" onclick="selectBank('中国银行')">中国银行</div>
                                <div class="dropdown-item" onclick="selectBank('交通银行')">交通银行</div>
                                <div class="dropdown-item" onclick="selectBank('招商银行')">招商银行</div>
                                <div class="dropdown-item" onclick="selectBank('浦发银行')">浦发银行</div>
                                <div class="dropdown-item" onclick="selectBank('中信银行')">中信银行</div>
                                <div class="dropdown-item" onclick="selectBank('光大银行')">光大银行</div>
                                <div class="dropdown-item" onclick="selectBank('华夏银行')">华夏银行</div>
                                <div class="dropdown-item" onclick="selectBank('民生银行')">民生银行</div>
                                <div class="dropdown-item" onclick="selectBank('广发银行')">广发银行</div>
                                <div class="dropdown-item" onclick="selectBank('平安银行')">平安银行</div>
                                <div class="dropdown-item" onclick="selectBank('兴业银行')">兴业银行</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="wheelEnabled">是否开启大转盘:</label>
                        <select id="wheelEnabled">
                            <option value="">全部</option>
                            <option value="是">是</option>
                            <option value="否">否</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">状态:</label>
                        <select id="status">
                            <option value="">全部</option>
                            <option value="生效中">生效中</option>
                            <option value="已终止">已终止</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="activityTime">活动时间:</label>
                        <div class="date-range">
                            <input type="date" id="startTime" title="开始时间">
                            <span>-</span>
                            <input type="date" id="endTime" title="结束时间">
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-default">重置</button>
                    <button class="btn btn-primary">搜索</button>
                </div>
            </div>
            
            <div class="data-table">
                <div class="table-header">
                    <div class="table-title">主题活动列表</div>
                    <div class="table-actions">
                        <button class="btn btn-secondary" id="addActivityBtn" onclick="openAddActivityModal()">新增</button>
                        <button class="btn btn-default" onclick="exportActivities()">导出</button>
                        <button class="btn btn-gray" onclick="showBatchPauseConfirm()">暂停</button>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th class="checkbox-col">
                                    <input type="checkbox" id="selectAll" title="全选" onchange="toggleSelectAll()">
                                </th>
                                <th>序号</th>
                                <th>主题活动ID</th>
                                <th>头寸编号</th>
                                <th>主题名称</th>
                                <th>报名机构</th>
                                <th>关联银行</th>
                                <th>活动时间</th>
                                <th>创建人</th>
                                <th>创建时间</th>
                                <th>最后修改人</th>
                                <th>最后修改时间</th>
                                <th>是否开启大转盘</th>
                                <th>状态</th>
                                <th class="action-col">操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 10条示例数据 -->
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>1</td>
                                <td>5000000084</td>
                                <td>02001018113100000000000</td>
                                <td>湖北银行扫码权益</td>
                                <td>10000001</td>
                                <td>20100001</td>
                                <td>2025-07-30 15:02:56 - 2025-08-30 15:02:56</td>
                                <td>曹政</td>
                                <td>2025-07-30 15:02:56</td>
                                <td>曹政</td>
                                <td>2025-07-30 15:02:56</td>
                                <td>否</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000084')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: inline;">开启转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>2</td>
                                <td>5000000085</td>
                                <td>02001018113100000000001</td>
                                <td>建设银行信用卡活动</td>
                                <td>10000002</td>
                                <td>20100002</td>
                                <td>2025-08-01 09:00:00 - 2025-09-01 09:00:00</td>
                                <td>李明</td>
                                <td>2025-07-31 10:15:22</td>
                                <td>李明</td>
                                <td>2025-07-31 10:15:22</td>
                                <td>是</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000085')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showConfigWheelModal('5000000085', event)">配置转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>3</td>
                                <td>5000000086</td>
                                <td>02001018113100000000002</td>
                                <td>工商银行消费返现</td>
                                <td>10000003</td>
                                <td>20100003</td>
                                <td>2025-08-05 00:00:00 - 2025-09-05 23:59:59</td>
                                <td>王芳</td>
                                <td>2025-08-01 14:30:45</td>
                                <td>王芳</td>
                                <td>2025-08-01 14:30:45</td>
                                <td>否</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000086')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: inline;">开启转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>4</td>
                                <td>5000000087</td>
                                <td>02001018113100000000003</td>
                                <td>农业银行新户专享</td>
                                <td>10000004</td>
                                <td>20100004</td>
                                <td>2025-07-25 00:00:00 - 2025-08-25 23:59:59</td>
                                <td>张伟</td>
                                <td>2025-07-24 16:45:12</td>
                                <td>张伟</td>
                                <td>2025-07-24 16:45:12</td>
                                <td>否</td>
                                <td><span class="status-badge status-inactive">已终止</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000087')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showEnableConfirm(this)">启用</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: none;">开启转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>5</td>
                                <td>5000000088</td>
                                <td>02001018113100000000004</td>
                                <td>中国银行周末特惠</td>
                                <td>10000005</td>
                                <td>20100005</td>
                                <td>2025-08-10 00:00:00 - 2025-09-10 23:59:59</td>
                                <td>刘强</td>
                                <td>2025-08-05 11:20:33</td>
                                <td>刘强</td>
                                <td>2025-08-05 11:20:33</td>
                                <td>是</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000088')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showConfigWheelModal('5000000088', event)">配置转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>6</td>
                                <td>5000000089</td>
                                <td>02001018113100000000005</td>
                                <td>招商银行餐饮优惠</td>
                                <td>10000006</td>
                                <td>20100006</td>
                                <td>2025-07-20 00:00:00 - 2025-08-20 23:59:59</td>
                                <td>陈丽</td>
                                <td>2025-07-19 09:15:47</td>
                                <td>陈丽</td>
                                <td>2025-07-19 09:15:47</td>
                                <td>否</td>
                                <td><span class="status-badge status-inactive">已终止</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000089')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showEnableConfirm(this)">启用</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: none;">开启转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>7</td>
                                <td>5000000090</td>
                                <td>02001018113100000000006</td>
                                <td>交通银行出行权益</td>
                                <td>10000007</td>
                                <td>20100007</td>
                                <td>2025-08-15 00:00:00 - 2025-09-15 23:59:59</td>
                                <td>赵磊</td>
                                <td>2025-08-10 13:40:21</td>
                                <td>赵磊</td>
                                <td>2025-08-10 13:40:21</td>
                                <td>是</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000090')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showConfigWheelModal('5000000090', event)">配置转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>8</td>
                                <td>5000000091</td>
                                <td>02001018113100000000007</td>
                                <td>中信银行购物节</td>
                                <td>10000008</td>
                                <td>20100008</td>
                                <td>2025-08-18 00:00:00 - 2025-09-18 23:59:59</td>
                                <td>孙莉</td>
                                <td>2025-08-12 15:25:36</td>
                                <td>孙莉</td>
                                <td>2025-08-12 15:25:36</td>
                                <td>否</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000091')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: inline;">开启转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>9</td>
                                <td>5000000092</td>
                                <td>02001018113100000000008</td>
                                <td>光大银行电影票优惠</td>
                                <td>10000009</td>
                                <td>20100009</td>
                                <td>2025-07-28 00:00:00 - 2025-08-28 23:59:59</td>
                                <td>周杰</td>
                                <td>2025-07-27 10:05:18</td>
                                <td>周杰</td>
                                <td>2025-07-27 10:05:18</td>
                                <td>是</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000092')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showConfigWheelModal('5000000092', event)">配置转盘</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col">
                                    <input type="checkbox" title="选择行" class="row-checkbox" onchange="updateSelectAll()">
                                </td>
                                <td>10</td>
                                <td>5000000093</td>
                                <td>02001018113100000000009</td>
                                <td>华夏银行生活缴费</td>
                                <td>10000010</td>
                                <td>20100010</td>
                                <td>2025-08-01 00:00:00 - 2025-09-01 23:59:59</td>
                                <td>吴敏</td>
                                <td>2025-07-30 17:50:44</td>
                                <td>吴敏</td>
                                <td>2025-07-30 17:50:44</td>
                                <td>否</td>
                                <td><span class="status-badge status-active">生效中</span></td>
                                <td class="action-col">
                                    <a href="#" class="action-link" onclick="showViewActivityModal()">查看</a> | 
                                    <a href="#" class="action-link" onclick="showEditActivityModal('5000000093')">编辑</a> | 
                                    <a href="#" class="action-link" onclick="showPauseConfirm(this)">暂停</a> | 
                                    <a href="#" class="action-link" onclick="showEnableWheelConfirm(this)" style="display: inline;">开启转盘</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination">
                    <div class="pagination-left">
                        <div class="pagination-info">共 90 条</div>
                        <div class="page-size-selector">
                            <span>每页显示</span>
                            <select class="page-size-select" title="选择每页显示条数">
                                <option>10</option>
                                <option>20</option>
                                <option>50</option>
                                <option>100</option>
                            </select>
                            <span>条</span>
                        </div>
                    </div>
                    <div class="pagination-controls">
                        <button class="page-btn" disabled>&lt;</button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn">4</button>
                        <button class="page-btn">5</button>
                        <button class="page-btn">6</button>
                        <button class="page-btn">7</button>
                        <button class="page-btn">8</button>
                        <button class="page-btn">9</button>
                        <button class="page-btn">&gt;</button>
                        <div style="display: flex; align-items: center; margin-left: 10px;">
                            <span style="margin-right: 5px;">跳至</span>
                            <input type="number" style="width: 50px; padding: 5px; border: 1px solid #dcdfe6; border-radius: 4px;" placeholder="1">
                            <span style="margin: 0 5px;">页</span>
                            <button class="btn btn-default" style="padding: 5px 10px;">确定</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 暂停活动确认弹窗 -->
    <div class="confirm-overlay" id="pauseConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-header">
                <h4>确认暂停活动</h4>
            </div>
            <div class="confirm-body">
                <p>确定要暂停此活动吗？暂停后活动将停止运行，可以重新启用。</p>
            </div>
            <div class="confirm-footer">
                <button type="button" class="btn-cancel" onclick="closePauseConfirm()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmPause()" style="background-color: #f56c6c;">确定暂停</button>
            </div>
        </div>
    </div>

    <!-- 批量暂停活动确认弹窗 -->
    <div class="confirm-overlay" id="batchPauseConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-header">
                <h4>确认批量暂停活动</h4>
            </div>
            <div class="confirm-body">
                <p>确定要暂停选中的活动吗？暂停后活动将停止运行，可以重新启用。</p>
                <p id="selectedCount" style="color: #f56c6c; font-weight: bold; margin-top: 10px;"></p>
            </div>
            <div class="confirm-footer">
                <button type="button" class="btn-cancel" onclick="closeBatchPauseConfirm()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmBatchPause()" style="background-color: #f56c6c;">确定暂停</button>
            </div>
        </div>
    </div>
    
    <!-- 启用活动确认弹窗 -->
    <div class="confirm-overlay" id="enableConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-header">
                <h4>确认启用活动</h4>
            </div>
            <div class="confirm-body">
                <p>确定要启用此活动吗？启用后活动将重新开始运行。</p>
            </div>
            <div class="confirm-footer">
                <button type="button" class="btn-cancel" onclick="closeEnableConfirm()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmEnable()" style="background-color: #67c23a;">确定启用</button>
            </div>
        </div>
    </div>
    
    <!-- 开启转盘确认弹窗 -->
    <div class="confirm-overlay" id="enableWheelConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-header">
                <h4>确认开启转盘</h4>
            </div>
            <div class="confirm-body">
                <p>开启转盘以后将不能再次关联微信活动，并且关联的活动不能超过10个，确定开启吗？</p>
            </div>
            <div class="confirm-footer">
                <button type="button" class="btn-cancel" onclick="closeEnableWheelConfirm()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmEnableWheel()" style="background-color: #409eff;">确定开启</button>
            </div>
        </div>
    </div>
    
    <!-- 新增主题活动右侧弹出模态框 -->
    <div class="slide-modal" id="addActivityModal">
        <div class="slide-modal-header">
            <h3>新增主题活动</h3>
            <button class="slide-modal-close" id="closeAddActivityModal">&times;</button>
        </div>
        <div class="slide-modal-body">
            <form id="addActivityForm">
                <div class="form-group">
                    <label for="newThemeName">* 主题名称：</label>
                    <input type="text" id="newThemeName" placeholder="请输入主题名称" required>
                </div>
                <div class="form-group">
                    <label for="newHeaderNumber">头寸编号：</label>
                    <select id="newHeaderNumber">
                        <option value="">请选择头寸编号</option>
                        <option value="02001018113100000000000">02001018113100000000000</option>
                        <option value="02001018113100000000001">02001018113100000000001</option>
                        <option value="02001018113100000000002">02001018113100000000002</option>
                        <option value="02001018113100000000003">02001018113100000000003</option>
                        <option value="02001018113100000000004">02001018113100000000004</option>
                        <option value="02001018113100000000005">02001018113100000000005</option>
                        <option value="02001018113100000000006">02001018113100000000006</option>
                        <option value="02001018113100000000007">02001018113100000000007</option>
                        <option value="02001018113100000000008">02001018113100000000008</option>
                        <option value="02001018113100000000009">02001018113100000000009</option>
                    </select>
                </div>
                <!-- 报名机构选择 -->
                <div class="form-group">
                    <label for="newInstitution">* 报名机构：</label>
                    <select id="newInstitution" required>
                        <option value="">请选择机构</option>
                        <option value="10000001">湖北银行 (10000001)</option>
                        <option value="10000002">建设银行 (10000002)</option>
                        <option value="10000003">工商银行 (10000003)</option>
                        <option value="10000004">农业银行 (10000004)</option>
                        <option value="10000005">中国银行 (10000005)</option>
                        <option value="10000006">招商银行 (10000006)</option>
                        <option value="10000007">交通银行 (10000007)</option>
                        <option value="10000008">中信银行 (10000008)</option>
                        <option value="10000009">光大银行 (10000009)</option>
                        <option value="10000010">华夏银行 (10000010)</option>
                    </select>
                </div>
                
                <!-- 关联银行选择 -->
                <div class="form-group">
                    <label for="newBank">关联银行：</label>
                    <select id="newBank">
                        <option value="">请选择银行</option>
                        <option value="20100001">中国工商银行</option>
                        <option value="20100002">中国银行</option>
                        <option value="20100003">中国建设银行</option>
                        <option value="20100004">中国农业银行</option>
                        <option value="20100005">招商银行</option>
                        <option value="20100006">交通银行</option>
                        <option value="20100007">中信银行</option>
                        <option value="20100008">光大银行</option>
                        <option value="20100009">华夏银行</option>
                        <option value="20100010">民生银行</option>
                        <option value="20100015">湖北银行</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newActivityTime">* 活动时间：</label>
                    <div class="date-range">
                        <input type="date" id="newStartTime" title="开始时间" required>
                        <span>~</span>
                        <input type="date" id="newEndTime" title="结束时间" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="newBackgroundImage">* 背景图：</label>
                    <div id="imageUploadArea" style="border: 1px dashed #ccc; width: 100px; height: 100px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                        <span id="uploadText" style="font-size: 24px;">+</span>
                        <img id="previewImage" src="" style="max-width: 100%; max-height: 100%; display: none;">
                    </div>
                    <p style="margin-top: 5px; color: #909399; font-size: 12px;">建议尺寸 375px*812px</p>
                    <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                </div>
                <div class="form-group">
                    <label for="newRules">* 规则说明：</label>
                    <textarea id="newRules" rows="4" required placeholder="请输入规则说明"></textarea>
                </div>
                <div class="form-group">
                    <label for="newParticipationLimit">* 参与限制：</label>
                    <span id="newParticipationLimit">每个用户最多可以参与</span>
                    <div style="margin-top: 5px;">
                        <input type="number" id="newMaxDraws" placeholder="最大领取次数" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="newParticipationLimitNote"></label>
                    <p style="margin-top: 5px; color: #909399; font-size: 12px;">如上传了6张优惠券信息，设置用户最大可参与6次，那么用户可以领取六张，若为4次，用户可以选择领取4张。</p>
                </div>
            </form>
        </div>
        <div class="slide-modal-footer">
            <button type="button" class="btn-confirm" id="submitAddActivity" style="background-color: #4a90e2;">确定</button>
        </div>
    </div>
    
    <!-- 编辑主题活动右侧弹出模态框 -->
    <div class="slide-modal" id="editActivityModal">
        <div class="slide-modal-header">
            <h3>编辑主题活动</h3>
            <button class="slide-modal-close" id="closeEditActivityModal">&times;</button>
        </div>
        <div class="slide-modal-body">
            <form id="editActivityForm">
                <div class="form-group">
                    <label for="editActivityId">主题活动ID：</label>
                    <input type="text" id="editActivityId" disabled>
                </div>
                <div class="form-group">
                    <label for="editThemeName">* 主题名称：</label>
                    <input type="text" id="editThemeName" placeholder="请输入主题名称" required>
                </div>
                <div class="form-group">
                    <label for="editHeaderNumber">头寸编号：</label>
                    <select id="editHeaderNumber">
                        <option value="">请选择头寸编号</option>
                        <option value="02001018113100000000000">02001018113100000000000</option>
                        <option value="02001018113100000000001">02001018113100000000001</option>
                        <option value="02001018113100000000002">02001018113100000000002</option>
                        <option value="02001018113100000000003">02001018113100000000003</option>
                        <option value="02001018113100000000004">02001018113100000000004</option>
                        <option value="02001018113100000000005">02001018113100000000005</option>
                        <option value="02001018113100000000006">02001018113100000000006</option>
                        <option value="02001018113100000000007">02001018113100000000007</option>
                        <option value="02001018113100000000008">02001018113100000000008</option>
                        <option value="02001018113100000000009">02001018113100000000009</option>
                    </select>
                </div>
                <!-- 报名机构选择 -->
                <div class="form-group">
                    <label for="editInstitution">* 报名机构：</label>
                    <select id="editInstitution" required>
                        <option value="">请选择机构</option>
                        <option value="10000001">湖北银行 (10000001)</option>
                        <option value="10000002">建设银行 (10000002)</option>
                        <option value="10000003">工商银行 (10000003)</option>
                        <option value="10000004">农业银行 (10000004)</option>
                        <option value="10000005">中国银行 (10000005)</option>
                        <option value="10000006">招商银行 (10000006)</option>
                        <option value="10000007">交通银行 (10000007)</option>
                        <option value="10000008">中信银行 (10000008)</option>
                        <option value="10000009">光大银行 (10000009)</option>
                        <option value="10000010">华夏银行 (10000010)</option>
                    </select>
                </div>
                
                <!-- 关联银行选择 -->
                <div class="form-group">
                    <label for="editBank">* 关联银行：</label>
                    <select id="editBank" required>
                        <option value="">请选择银行</option>
                        <option value="20100001">中国工商银行</option>
                        <option value="20100002">中国银行</option>
                        <option value="20100003">中国建设银行</option>
                        <option value="20100004">中国农业银行</option>
                        <option value="20100005">招商银行</option>
                        <option value="20100006">交通银行</option>
                        <option value="20100007">中信银行</option>
                        <option value="20100008">光大银行</option>
                        <option value="20100009">华夏银行</option>
                        <option value="20100010">民生银行</option>
                        <option value="20100015">湖北银行</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editActivityTime">* 活动时间：</label>
                    <div class="date-range">
                        <input type="date" id="editStartTime" title="开始时间" required>
                        <span>~</span>
                        <input type="date" id="editEndTime" title="结束时间" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="editBackgroundImage">* 背景图：</label>
                    <div id="editImageUploadArea" style="border: 1px dashed #ccc; width: 100px; height: 100px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                        <span id="editUploadText" style="font-size: 24px;">+</span>
                        <img id="editPreviewImage" src="" style="max-width: 100%; max-height: 100%; display: none;">
                    </div>
                    <p style="margin-top: 5px; color: #909399; font-size: 12px;">建议尺寸 375px*812px</p>
                    <input type="file" id="editImageUpload" accept="image/*" style="display: none;">
                </div>
                <div class="form-group">
                    <label for="editRules">* 规则说明：</label>
                    <textarea id="editRules" rows="4" required placeholder="请输入规则说明"></textarea>
                </div>
                <div class="form-group">
                    <label for="editParticipationLimit">* 参与限制：</label>
                    <span id="editParticipationLimit">每个用户最多可以参与</span>
                    <div style="margin-top: 5px;">
                        <input type="number" id="editMaxDraws" placeholder="最大领取次数" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="editParticipationLimitNote"></label>
                    <p style="margin-top: 5px; color: #909399; font-size: 12px;">如上传了6张优惠券信息，设置用户最大可参与6次，那么用户可以领取六张，若为4次，用户可以选择领取4张。</p>
                </div>
            </form>
        </div>
        <div class="slide-modal-footer">
            <button type="button" class="btn-confirm" id="submitEditActivity" style="background-color: #4a90e2;">确定</button>
        </div>
    </div>
    
    <!-- 查看活动详情右侧弹出模态框 -->
    <div class="slide-modal" id="viewActivityModal">
        <div class="slide-modal-header">
            <h3>查看活动详情</h3>
        </div>
        <div class="slide-modal-body">
            <!-- 标签页 -->
            <div class="tab-container">
                <div class="tab-header">
                    <div class="tab-item active" data-tab="batch">查看批次数据</div>
                    <div class="tab-item" data-tab="merchant">查看商户</div>
                    <div class="tab-item" data-tab="qrcode">查看二维码/链接</div>
                </div>
                <div class="tab-content">
                    <!-- 查看批次数据内容 -->
                    <div class="tab-pane active" id="batch-content">
                        <!-- 批次号筛选项 -->
                        <div class="query-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="batchId">批次号</label>
                                    <input type="text" id="batchId" placeholder="请输入批次号">
                                </div>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary" onclick="searchBatches()">搜索</button>
                                <button class="btn btn-default" onclick="resetBatchSearch()">重置</button>
                            </div>
                        </div>
                        <!-- 批次数据列表 -->
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>微信活动ID</th>
                                        <th>批次号</th>
                                        <th>券面额</th>
                                        <th>领取数量</th>
                                        <th>核销数量</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>5000000084</td>
                                        <td>B001</td>
                                        <td>10元</td>
                                        <td>200</td>
                                        <td>150</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>5000000085</td>
                                        <td>B002</td>
                                        <td>20元</td>
                                        <td>150</td>
                                        <td>120</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- 查看商户内容 -->
                    <div class="tab-pane" id="merchant-content">
                        <div class="query-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="merchantId">商户号</label>
                                    <input type="text" id="merchantId" placeholder="请输入商户号">
                                </div>
                            </div>
                            <div class="form-actions">
                                <button class="btn btn-primary" onclick="searchMerchants()">搜索</button>
                                <button class="btn btn-default" onclick="resetMerchantSearch()">重置</button>
                            </div>
                        </div>
                        <div class="table-actions" style="margin: 15px 0;">
                            <button class="btn btn-secondary" onclick="batchBindMerchants()">批量绑定</button>
                            <button class="btn btn-gray" onclick="exportMerchants()">导出</button>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>商户号</th>
                                        <th>业主 ID</th>
                                        <th>业主名称</th>
                                        <th>活动开始时间</th>
                                        <th>活动结束时间</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>1</td>
                                        <td>10000001</td>
                                        <td>YZ001</td>
                                        <td>湖北银行</td>
                                        <td>2023-01-01</td>
                                        <td>2023-12-31</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>10000002</td>
                                        <td>YZ002</td>
                                        <td>建设银行</td>
                                        <td>2023-01-01</td>
                                        <td>2023-12-31</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- 查看二维码/链接内容 -->
                    <div class="tab-pane" id="qrcode-content">
                        <div class="qrcode-container">
                            <div class="qrcode-item">
                                <div class="qrcode-title">活动二维码</div>
                                <div class="qrcode-image">
                                    <!-- 这里应该是实际的二维码图片 -->
                                    <div style="width: 150px; height: 150px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center;">
                                        二维码区域
                                    </div>
                                </div>
                                <div class="qrcode-info">
                                    <div class="qrcode-info-item">
                                        <span class="info-label">微信小程序AppID:</span>
                                        <span class="info-value">wx59c561a4c06eed3c</span>
                                    </div>
                                    <div class="qrcode-info-item">
                                        <span class="info-label">PATH:</span>
                                        <span class="info-value">pages/home/coupons/bmt-activity?activityId=5000000085</span>
                                    </div>
                                </div>
                                <div class="qrcode-link">
                                    <!-- 链接地址显示已移除 -->
                                </div>
                                <div class="qrcode-actions">
                                    <button class="btn btn-primary" onclick="copyLink()">复制链接</button>
                                    <button class="btn btn-secondary" onclick="downloadQRCode()">下载二维码</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 报名机构管理模态框 -->
    <div class="slide-modal" id="institutionModal">
        <div class="slide-modal-header">
            <h3>报名机构管理</h3>
            <button class="slide-modal-close" id="closeInstitutionModal">&times;</button>
        </div>
        <div class="slide-modal-body">
            <!-- 筛选区域 -->
            <div class="query-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="filterInstitutionId">机构号:</label>
                        <input type="text" id="filterInstitutionId" placeholder="请输入机构号">
                    </div>
                    <div class="form-group">
                        <label for="filterInstitutionName">机构名称:</label>
                        <input type="text" id="filterInstitutionName" placeholder="请输入机构名称">
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-default" onclick="resetInstitutionFilter()">重置</button>
                    <button class="btn btn-primary" onclick="searchInstitutions()">搜索</button>
                </div>
            </div>
            
            <!-- 操作区域 -->
            <div class="table-actions">
                <div class="table-actions-left">
                    <label for="institutionSelect">机构号:</label>
                    <select id="institutionSelect" title="选择机构">
                        <option value="">请选择机构</option>
                        <option value="10000001">湖北银行 (10000001)</option>
                        <option value="10000002">建设银行 (10000002)</option>
                        <option value="10000003">工商银行 (10000003)</option>
                        <option value="10000004">农业银行 (10000004)</option>
                        <option value="10000005">中国银行 (10000005)</option>
                        <option value="10000006">招商银行 (10000006)</option>
                        <option value="10000007">交通银行 (10000007)</option>
                        <option value="10000008">中信银行 (10000008)</option>
                        <option value="10000009">光大银行 (10000009)</option>
                        <option value="10000010">华夏银行 (10000010)</option>
                    </select>
                    <button class="btn btn-secondary" onclick="addInstitution()">新增</button>
                </div>
                <div class="table-actions-right">
                    <button class="btn btn-danger" onclick="batchDeleteInstitutions()">批量删除</button>
                    <button class="btn btn-primary" onclick="batchImportInstitutions()">批量导入</button>
                </div>
            </div>
            
            <!-- 数据表格 -->
            <div class="data-table">
                <div class="table-container" style="overflow-x: auto; position: relative;">
                    <table style="min-width: 600px;">
                        <thead>
                            <tr>
                                <th class="checkbox-col" style="width: 50px; text-align: center;">
                                    <input type="checkbox" id="selectAllInstitutions" title="全选" onchange="toggleSelectAllInstitutions()">
                                </th>
                                <th style="width: 80px;">序号</th>
                                <th style="width: 120px;">机构号</th>
                                <th style="width: 150px;">机构名称</th>
                                <th style="width: 180px;">报名时间</th>
                                <th style="width: 100px;">操作人员</th>
                                <th class="action-col" style="width: 80px; position: sticky; right: 0; background-color: #fafafa; z-index: 10; box-shadow: -2px 0 4px rgba(0,0,0,0.1);">操作</th>
                            </tr>
                        </thead>
                        <tbody id="institutionTableBody">
                            <tr>
                                <td class="checkbox-col" style="text-align: center;">
                                    <input type="checkbox" class="institution-checkbox" value="10000001" title="选择行" onchange="updateSelectAllInstitutions()">
                                </td>
                                <td>1</td>
                                <td>10000001</td>
                                <td>湖北银行</td>
                                <td>2025-07-30 15:02:56</td>
                                <td>曹政</td>
                                <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                                    <a href="#" class="action-link" onclick="deleteInstitution(this, '10000001')" style="color: #f56c6c;">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col" style="text-align: center;">
                                    <input type="checkbox" class="institution-checkbox" value="10000003" title="选择行" onchange="updateSelectAllInstitutions()">
                                </td>
                                <td>2</td>
                                <td>10000003</td>
                                <td>工商银行</td>
                                <td>2025-08-01 14:30:45</td>
                                <td>王芳</td>
                                <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                                    <a href="#" class="action-link" onclick="deleteInstitution(this, '10000003')" style="color: #f56c6c;">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col" style="text-align: center;">
                                    <input type="checkbox" class="institution-checkbox" value="10000005" title="选择行" onchange="updateSelectAllInstitutions()">
                                </td>
                                <td>3</td>
                                <td>10000005</td>
                                <td>中国银行</td>
                                <td>2025-08-05 11:20:33</td>
                                <td>刘强</td>
                                <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                                    <a href="#" class="action-link" onclick="deleteInstitution(this, '10000005')" style="color: #f56c6c;">删除</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 分页 -->
                <div class="pagination">
                    <div class="pagination-left">
                        <div class="pagination-info">共 3 条</div>
                        <div class="page-size-selector">
                            <span>每页显示</span>
                            <select class="page-size-select" title="选择每页显示条数">
                                <option>10</option>
                                <option>20</option>
                                <option>50</option>
                                <option>100</option>
                            </select>
                            <span>条</span>
                        </div>
                    </div>
                    <div class="pagination-controls">
                        <button class="page-btn" disabled>&lt;</button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">&gt;</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 关联银行管理模态框 -->
    <div class="slide-modal" id="bankModal">
        <div class="slide-modal-header">
            <h3>关联银行管理</h3>
            <button class="slide-modal-close" onclick="closeBankModal()">&times;</button>
        </div>
        <div class="slide-modal-body">
            <!-- 筛选区域 -->
            <div class="query-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="filterBankCode">银行ID:</label>
                        <input type="text" id="filterBankCode" placeholder="请输入银行ID">
                    </div>
                    <div class="form-group">
                        <label for="filterBankName">银行名称:</label>
                        <input type="text" id="filterBankName" placeholder="请输入银行名称">
                    </div>
                </div>
                <div class="form-actions">
                    <button class="btn btn-default" onclick="resetBankFilter()">重置</button>
                    <button class="btn btn-primary" onclick="searchBanks()">搜索</button>
                </div>
            </div>
            
            <!-- 操作区域 -->
            <div class="table-actions">
                <div class="table-actions-left">
                    <label for="bankSelect">银行ID:</label>
                    <select id="bankSelect" title="选择银行">
                        <option value="">请选择银行</option>
                        <option value="20100001">中国工商银行</option>
                        <option value="20100002">中国银行</option>
                        <option value="20100003">中国建设银行</option>
                        <option value="20100004">中国农业银行</option>
                        <option value="20100005">招商银行</option>
                        <option value="20100006">交通银行</option>
                        <option value="20100007">中信银行</option>
                        <option value="20100008">光大银行</option>
                        <option value="20100009">华夏银行</option>
                        <option value="20100010">民生银行</option>
                        <option value="20100015">湖北银行</option>
                    </select>
                    <button class="btn btn-secondary" onclick="addBank()">新增</button>
                </div>
                <div class="table-actions-right">
                    <button class="btn btn-danger" onclick="batchDeleteBanks()">批量删除</button>
                    <button class="btn btn-primary" onclick="batchImportBanks()">批量导入</button>
                </div>
            </div>
            
            <!-- 数据表格 -->
            <div class="data-table">
                <div class="table-container" style="overflow-x: auto; position: relative;">
                    <table style="min-width: 600px;">
                        <thead>
                            <tr>
                                <th class="checkbox-col" style="width: 50px;">
                                    <input type="checkbox" id="selectAllBanks" title="全选" onchange="toggleSelectAllBanks()">
                                </th>
                                <th style="width: 80px;">序号</th>
                                <th style="width: 120px;">银行ID</th>
                                <th style="width: 150px;">银行名称</th>
                                <th style="width: 180px;">关联时间</th>
                                <th style="width: 100px;">操作人员</th>
                                <th class="action-col" style="width: 80px; position: sticky; right: 0; background-color: #fafafa; z-index: 10; box-shadow: -2px 0 4px rgba(0,0,0,0.1);">操作</th>
                            </tr>
                        </thead>
                        <tbody id="bankTableBody">
                            <!-- 示例数据 -->
                            <tr>
                                <td class="checkbox-col" style="text-align: center;">
                                    <input type="checkbox" class="bank-checkbox" value="ICBC" title="选择行" onchange="updateSelectAllBanks()">
                                </td>
                                <td>1</td>
                                <td>ICBC</td>
                                <td>中国工商银行</td>
                                <td>2025-07-30 15:02:56</td>
                                <td>曹政</td>
                                <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                                    <a href="#" class="action-link" onclick="deleteBank(this, 'ICBC')" style="color: #f56c6c;">删除</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="checkbox-col" style="text-align: center;">
                                    <input type="checkbox" class="bank-checkbox" value="BOC" title="选择行" onchange="updateSelectAllBanks()">
                                </td>
                                <td>2</td>
                                <td>BOC</td>
                                <td>中国银行</td>
                                <td>2025-08-01 09:00:00</td>
                                <td>李明</td>
                                <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                                    <a href="#" class="action-link" onclick="deleteBank(this, 'BOC')" style="color: #f56c6c;">删除</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 分页 -->
                <div class="pagination">
                    <div class="pagination-left">
                        <div class="pagination-info">共 2 条</div>
                        <div class="page-size-selector">
                            <span>每页显示</span>
                            <select class="page-size-select" title="选择每页显示条数">
                                <option>10</option>
                                <option>20</option>
                                <option>50</option>
                                <option>100</option>
                            </select>
                            <span>条</span>
                        </div>
                    </div>
                    <div class="pagination-controls">
                        <button class="page-btn" disabled>&lt;</button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">&gt;</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 暂停活动确认相关函数
        let currentPauseElement = null;

        function showPauseConfirm(element) {
            currentPauseElement = element;
            const modal = document.getElementById('pauseConfirmModal');
            modal.classList.add('show');
        }

        function closePauseConfirm() {
            const modal = document.getElementById('pauseConfirmModal');
            modal.classList.remove('show');
            currentPauseElement = null;
        }

        function confirmPause() {
            if (currentPauseElement) {
                // 获取当前行的活动信息
                const row = currentPauseElement.closest('tr');
                const activityName = row.cells[4].textContent.trim();

                // 这里可以添加实际的暂停活动逻辑
                // 例如发送AJAX请求到后端
                console.log('暂停活动:', activityName);

                // 模拟暂停成功，更新状态
                const statusCell = row.cells[12];
                statusCell.innerHTML = '<span class="status-badge status-inactive">已暂停</span>';

                // 将暂停按钮改为启用按钮
                currentPauseElement.textContent = '启用';
                currentPauseElement.onclick = function() { showEnableConfirm(this); };

                alert('活动已成功暂停！');
            }
            closePauseConfirm();
        }

        // 启用活动确认相关函数
        let currentEnableElement = null;

        function showEnableConfirm(element) {
            currentEnableElement = element;
            const modal = document.getElementById('enableConfirmModal');
            modal.classList.add('show');
        }

        function closeEnableConfirm() {
            const modal = document.getElementById('enableConfirmModal');
            modal.classList.remove('show');
            currentEnableElement = null;
        }

        function confirmEnable() {
            if (currentEnableElement) {
                // 获取当前行的活动信息
                const row = currentEnableElement.closest('tr');
                const activityName = row.cells[4].textContent.trim();

                // 这里可以添加实际的启用活动逻辑
                // 例如发送AJAX请求到后端
                console.log('启用活动:', activityName);

                // 模拟启用成功，更新状态
                const statusCell = row.cells[12];
                statusCell.innerHTML = '<span class="status-badge status-active">生效中</span>';

                // 将启用按钮改为暂停按钮
                currentEnableElement.textContent = '暂停';
                currentEnableElement.onclick = function() { showPauseConfirm(this); };

                alert('活动已成功启用！');
            }
            closeEnableConfirm();
        }

        // 批量暂停活动相关函数
        function showBatchPauseConfirm() {
            const checkedBoxes = document.querySelectorAll('.row-checkbox:checked');

            if (checkedBoxes.length === 0) {
                alert('请先选择要暂停的活动！');
                return;
            }

            // 显示选中的活动数量
            const selectedCountElement = document.getElementById('selectedCount');
            selectedCountElement.textContent = `已选中 ${checkedBoxes.length} 个活动`;

            const modal = document.getElementById('batchPauseConfirmModal');
            modal.classList.add('show');
        }

        function closeBatchPauseConfirm() {
            const modal = document.getElementById('batchPauseConfirmModal');
            modal.classList.remove('show');
        }

        function confirmBatchPause() {
            const checkedBoxes = document.querySelectorAll('.row-checkbox:checked');
            let pausedCount = 0;

            checkedBoxes.forEach(checkbox => {
                const row = checkbox.closest('tr');
                const statusCell = row.cells[12];
                const pauseLink = row.querySelector('.action-link[onclick*="showPauseConfirm"]');

                // 只暂停生效中的活动
                if (statusCell.textContent.includes('生效中')) {
                    // 更新状态
                    statusCell.innerHTML = '<span class="status-badge status-inactive">已暂停</span>';

                    // 将暂停按钮改为启用按钮
                    if (pauseLink) {
                        pauseLink.textContent = '启用';
                        pauseLink.onclick = function() { showEnableConfirm(this); };
                    }

                    // 取消选中
                    checkbox.checked = false;
                    pausedCount++;
                }
            });
            
            alert(`成功暂停 ${pausedCount} 个活动！`);
            closeBatchPauseConfirm();
        }

        // 全选/取消全选功能
        function toggleSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAll');
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');
            
            // 为所有行复选框设置与全选复选框相同的状态
            rowCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
        }

        // 更新全选状态
        function updateSelectAll() {
            const selectAllCheckbox = document.getElementById('selectAll');
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');
            const checkedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
            
            // 如果所有行复选框都被选中，则全选复选框也选中
            selectAllCheckbox.checked = rowCheckboxes.length === checkedCheckboxes.length;
        }
        
        // 新增主题活动相关函数
        function showAddActivityModal() {
            console.log('Attempting to show add activity modal');
            const modal = document.getElementById('addActivityModal');
            console.log('Add activity modal element:', modal);
            if (modal) {
                console.log('Modal before adding show class:', modal.classList);
                // 添加一个微小的延迟，确保DOM更新完成
                setTimeout(() => {
                    modal.classList.add('show');
                    console.log('Modal after adding show class:', modal.classList);
                    console.log('Add activity modal shown');
                }, 10);
            } else {
                console.log('Add activity modal not found');
            }
        }

        function closeAddActivityModal() {
            const modal = document.getElementById('addActivityModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        function submitAddActivityForm() {
            // 获取表单数据
            const themeName = document.getElementById('newThemeName').value;
            const headerNumber = document.getElementById('newHeaderNumber').value;
            const institution = document.getElementById('newInstitution').value;
            const associatedBank = document.getElementById('newAssociatedBank').value;
            const startTime = document.getElementById('newStartTime').value;
            const endTime = document.getElementById('newEndTime').value;
            const rules = document.getElementById('newRules').value;
            const maxDraws = document.getElementById('newMaxDraws').value;
            
            // 验证必填项
            if (!themeName || !startTime || !endTime || !rules || !maxDraws) {
                alert('请填写所有必填项！');
                return;
            }
            
            // 验证报名机构
            if (!institution) {
                alert('请选择报名机构！');
                return;
            }
            
            // 验证关联银行
            if (!associatedBank) {
                alert('请选择关联银行！');
                return;
            }
            
            // 这里可以添加实际的表单提交逻辑
            // 例如发送AJAX请求到后端
            console.log('新增主题活动:', {
                themeName,
                headerNumber,
                institution,
                associatedBank,
                startTime,
                endTime,
                rules,
                maxDraws
            });
            
            // 模拟提交成功，关闭模态框并重置表单
            closeAddActivityModal();
            resetAddActivityForm();
            alert('主题活动新增成功！');
        }
        
        // 编辑主题活动相关函数
        function showEditActivityModal(activityId) {
            console.log('Attempting to show edit activity modal with activityId:', activityId);
            const modal = document.getElementById('editActivityModal');
            console.log('Edit activity modal element:', modal);
            if (modal) {
                // 设置主题活动ID并加载数据
                loadActivityData(activityId);
                
                // 添加一个微小的延迟，确保DOM更新完成
                setTimeout(() => {
                    modal.classList.add('show');
                    console.log('Edit activity modal shown');
                }, 10);
            } else {
                console.log('Edit activity modal not found');
            }
        }

        // 加载活动数据到编辑表单
        function loadActivityData(activityId) {
            // 从数据表格中获取对应行的真实数据
            const tableRows = document.querySelectorAll('.table-container table tbody tr');
            let rowData = null;
            
            // 查找对应的行数据
            for (let row of tableRows) {
                const cells = row.querySelectorAll('td');
                if (cells.length > 2 && cells[2].textContent.trim() === activityId) {
                    rowData = {
                        activityId: cells[2].textContent.trim(),
                        headerNumber: cells[3].textContent.trim(),
                        themeName: cells[4].textContent.trim(),
                        institution: cells[5].textContent.trim(),
                        associatedBank: cells[6].textContent.trim(),
                        activityTime: cells[7].textContent.trim()
                    };
                    break;
                }
            }
            
            // 如果没有找到对应数据，使用默认值
            if (!rowData) {
                rowData = {
                    activityId: activityId,
                    headerNumber: '',
                    themeName: '示例活动',
                    institution: '',
                    associatedBank: '',
                    activityTime: '2024-01-01 00:00:00 - 2024-12-31 23:59:59'
                };
            }
            
            // 解析活动时间
            const timeRange = rowData.activityTime.split(' - ');
            const startTime = timeRange[0] ? timeRange[0].split(' ')[0] : '2024-01-01';
            const endTime = timeRange[1] ? timeRange[1].split(' ')[0] : '2024-12-31';

            // 填充表单字段
            document.getElementById('editActivityId').value = rowData.activityId;
            document.getElementById('editThemeName').value = rowData.themeName;
            document.getElementById('editHeaderNumber').value = rowData.headerNumber;
            document.getElementById('editStartTime').value = startTime;
            document.getElementById('editEndTime').value = endTime;
            document.getElementById('editRules').value = '活动规则示例';
            document.getElementById('editMaxDraws').value = '3';

            // 设置单选下拉框的值并设为只读
            const institutionSelect = document.getElementById('editInstitution');
            const bankSelect = document.getElementById('editBank');
            
            institutionSelect.value = rowData.institution;
            bankSelect.value = rowData.associatedBank;
            
            // 设置为只读状态
            institutionSelect.disabled = true;
            bankSelect.disabled = true;

            console.log('已加载活动数据:', rowData);
        }

        function closeEditActivityModal() {
            const modal = document.getElementById('editActivityModal');
            if (modal) {
                modal.classList.remove('show');
                // 重置编辑表单
                resetEditActivityForm();
            }
        }

        function resetEditActivityForm() {
            document.getElementById('editActivityForm').reset();
            // 重置图片上传区域
            document.getElementById('editPreviewImage').style.display = 'none';
            document.getElementById('editUploadText').style.display = 'block';
            // 重置单选下拉框并恢复可编辑状态
            const institutionSelect = document.getElementById('editInstitution');
            const bankSelect = document.getElementById('editBank');
            
            institutionSelect.value = '';
            bankSelect.value = '';
            institutionSelect.disabled = false;
            bankSelect.disabled = false;
        }

        function submitEditActivityForm() {
            // 获取表单数据
            const activityId = document.getElementById('editActivityId').value;
            const themeName = document.getElementById('editThemeName').value;
            const headerNumber = document.getElementById('editHeaderNumber').value;
            const institution = document.getElementById('editInstitution').value;
            const associatedBank = document.getElementById('editBank').value;
            const startTime = document.getElementById('editStartTime').value;
            const endTime = document.getElementById('editEndTime').value;
            const rules = document.getElementById('editRules').value;
            const maxDraws = document.getElementById('editMaxDraws').value;
            
            // 验证必填项（报名机构和关联银行为只读，不需要验证）
            if (!themeName || !startTime || !endTime || !rules || !maxDraws) {
                alert('请填写所有必填项！');
                return;
            }
            
            // 先关闭模态框
            closeEditActivityModal();
            
            // 延迟显示确认弹窗，确保模态框完全关闭
            setTimeout(() => {
                // 这里可以添加实际的表单提交逻辑
                // 例如发送AJAX请求到后端
                console.log('编辑主题活动:', {
                    activityId,
                    themeName,
                    headerNumber,
                    institution,
                    associatedBank,
                    startTime,
                    endTime,
                    rules,
                    maxDraws
                });
                
                // 显示成功提示
                alert('主题活动编辑成功！');
            }, 300);
        }
        
        // 开启转盘确认相关函数
        let currentEnableWheelElement = null;
        
        function showEnableWheelConfirm(element) {
            currentEnableWheelElement = element;
            const modal = document.getElementById('enableWheelConfirmModal');
            modal.classList.add('show');
        }
        
        function closeEnableWheelConfirm() {
            const modal = document.getElementById('enableWheelConfirmModal');
            modal.classList.remove('show');
            currentEnableWheelElement = null;
        }
        
        function confirmEnableWheel() {
            // 这里可以添加实际的开启转盘逻辑
            // 例如发送AJAX请求到后端
            console.log('开启转盘');
            
            // 模拟开启成功
            alert('转盘开启成功！');
            
            // 关闭弹窗
            closeEnableWheelConfirm();
        }
        
        // 配置转盘相关函数
        let currentConfigActivityId = null;
        let currentColorTarget = null;
        let wheelConfigData = [];
        
        // 默认颜色数组
        const defaultColors = [
            '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
            '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9'
        ];
        
        function showConfigWheelModal(activityId, event) {
            // 阻止事件冒泡，防止触发外部点击关闭事件
            if (event) {
                event.stopPropagation();
                event.preventDefault();
            }
            
            currentConfigActivityId = activityId;
            
            // 加载配置数据
            loadWheelConfigData(activityId);
            
            // 显示模态框
            const modal = document.getElementById('configWheelModal');
            modal.classList.add('show');
        }
        
        function closeConfigWheelModal() {
            const modal = document.getElementById('configWheelModal');
            modal.classList.remove('show');
            currentConfigActivityId = null;
        }
        
        function loadWheelConfigData(activityId) {
            // 模拟加载已关联主题活动的微信活动数据
            // 实际项目中应该从后端获取
            const mockData = [
                { 
                    order: 1, 
                    content: '建行 2025 开门红活动\n20250101 - 20250331', 
                    color: '#FF6B6B', 
                    weight: 20 
                },
                { 
                    order: 2, 
                    content: '工行消费返现活动\n20250201 - 20250430', 
                    color: '#4ECDC4', 
                    weight: 25 
                },
                { 
                    order: 3, 
                    content: '中行周末特惠活动\n20250301 - 20250531', 
                    color: '#45B7D1', 
                    weight: 30 
                },
                { 
                    order: 4, 
                    content: '招行餐饮优惠活动\n20250401 - 20250630', 
                    color: '#96CEB4', 
                    weight: 25 
                }
            ];
            
            wheelConfigData = mockData;
            renderWheelConfigTable();
        }
        
        function renderWheelConfigTable() {
            const tbody = document.getElementById('wheelConfigTableBody');
            
            // 确保DOM元素存在
            if (!tbody) {
                return;
            }
            
            tbody.innerHTML = '';
            
            wheelConfigData.forEach((item, index) => {
                // 判断是否为新增项（内容为默认模板）
                const isNewItem = item.content.includes('新增活动');
                
                // 解析活动内容
                const contentLines = item.content.split('\n');
                const activityName = contentLines[0] || '';
                const activityDate = contentLines[1] || '';
                
                // 解析活动ID和时间范围
                const activityId = activityName.match(/ID[：:]?\s*(\w+)/) ? activityName.match(/ID[：:]?\s*(\w+)/)[1] : 'WX16000000116353453253';
                const cleanActivityName = activityName.replace(/ID[：:]?\s*\w+\s*/, '').trim();
                const timeRange = activityDate.split('-');
                const startTime = timeRange[0] ? timeRange[0].trim() : '';
                const endTime = timeRange[1] ? timeRange[1].trim() : '';
                
                // 生成内容显示区域
                const contentDisplay = isNewItem ? 
                    `<textarea class="content-input" rows="2" 
                              onchange="updateConfigItem(${index}, 'content', this.value)">${item.content}</textarea>` :
                    `<div class="activity-content-card" style="background-color: ${item.color}" onclick="editActivityContent(${index})">
                        <div class="left-content">
                            <div class="activity-id">ID: ${activityId}</div>
                            <div class="activity-title">${cleanActivityName}</div>
                        </div>
                        <div class="right-content">
                            <div class="activity-start-time">${startTime}</div>
                            <div class="activity-end-time">${endTime}</div>
                        </div>
                    </div>`;
                
                // 创建删除按钮（第一行禁用，其他行可点击）
                const isFirstRow = index === 0;
                const deleteButton = isFirstRow ? 
                    `<button class="btn-delete disabled" disabled>删除</button>` :
                    `<button class="btn-delete" onclick="deleteConfigItem(${index})">删除</button>`;
                
                // 创建表格行（顺序、内容、颜色、权重、操作）
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <input type="number" class="order-input" value="${item.order}" 
                               onchange="updateConfigItem(${index}, 'order', this.value)" min="1">
                    </td>
                    <td>
                        ${contentDisplay}
                    </td>
                    <td>
                        <div class="color-display" style="background-color: ${item.color}" 
                             onclick="showColorPicker(${index})"></div>
                    </td>
                    <td>
                        <input type="number" class="weight-input" value="${item.weight}" 
                               onchange="updateConfigItem(${index}, 'weight', this.value)" min="1" max="100">
                    </td>
                    <td class="action-cell">
                        ${deleteButton}
                    </td>
                `;
                
                // 插入到表格中
                tbody.appendChild(row);
                

            });
            
            // 渲染完成后，调整所有内容卡片的宽度，使其按最长文本自适应并保持一致
            setTimeout(() => {
                adjustCardWidths();
            }, 100);
        }
        
        // 调整所有内容卡片的宽度，使其按最长文本自适应并保持一致
        function adjustCardWidths() {
            const cards = document.querySelectorAll('.activity-content-card');
            if (cards.length === 0) return;
            
            let maxWidth = 0;
            
            // 临时设置为auto以测量实际宽度
            cards.forEach(card => {
                card.style.width = 'auto';
                card.style.minWidth = 'auto';
                card.style.maxWidth = 'none';
            });
            
            // 测量每个卡片的实际宽度
            cards.forEach(card => {
                const cardWidth = card.offsetWidth;
                maxWidth = Math.max(maxWidth, cardWidth);
            });
            
            // 确保最小宽度和最大宽度限制
            maxWidth = Math.max(maxWidth, 120); // 最小120px
            maxWidth = Math.min(maxWidth, 180); // 最大180px
            
            // 统一设置所有卡片的宽度
            cards.forEach(card => {
                card.style.width = maxWidth + 'px';
                card.style.minWidth = maxWidth + 'px';
                card.style.maxWidth = maxWidth + 'px';
            });
        }
        
        // 编辑活动内容函数
        function editActivityContent(index) {
            const item = wheelConfigData[index];
            const newContent = prompt('编辑活动内容（格式：活动名称\n时间范围）:', item.content);
            if (newContent !== null && newContent.trim() !== '') {
                updateConfigItem(index, 'content', newContent);
                renderWheelConfigTable();
            }
        }
        
        function updateConfigItem(index, field, value) {
            if (wheelConfigData[index]) {
                wheelConfigData[index][field] = value;
            }
        }
        

        
        function addWheelConfigItem() {
            const newOrder = wheelConfigData.length + 1;
            const newColor = defaultColors[wheelConfigData.length % defaultColors.length];
            
            const newItem = {
                order: newOrder,
                content: '新增活动\n20250101 - 20251231',
                color: newColor,
                weight: 10
            };
            
            wheelConfigData.push(newItem);
            renderWheelConfigTable();
        }
        
        // 颜色选择器相关函数
        function showColorPicker(index) {
            currentColorTarget = index;
            const overlay = document.getElementById('colorPickerOverlay');
            overlay.style.display = 'flex';
            
            // 设置当前颜色
            const currentColor = wheelConfigData[index].color;
            document.getElementById('customColorInput').value = currentColor;
            
            // 清除之前的选中状态
            document.querySelectorAll('.color-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // 标记当前选中的颜色
            const colorItem = document.querySelector(`[data-color="${currentColor}"]`);
            if (colorItem) {
                colorItem.classList.add('selected');
            }
        }
        
        function closeColorPicker() {
            const overlay = document.getElementById('colorPickerOverlay');
            overlay.style.display = 'none';
            currentColorTarget = null;
        }
        
        function confirmColorSelection() {
            if (currentColorTarget === null) return;
            
            const selectedColor = document.querySelector('.color-item.selected');
            let color;
            
            if (selectedColor) {
                color = selectedColor.getAttribute('data-color');
            } else {
                color = document.getElementById('customColorInput').value;
            }
            
            // 更新配置数据
            wheelConfigData[currentColorTarget].color = color;
            
            // 重新渲染表格
            renderWheelConfigTable();
            
            // 关闭颜色选择器
            closeColorPicker();
        }
        
        // 配置转盘确认相关函数
        function showConfigWheelConfirm() {
            // 先关闭配置转盘模态框
            closeConfigWheelModal();
            
            // 然后显示确认弹窗
            const modal = document.getElementById('configWheelConfirmModal');
            modal.classList.add('show');
        }
        
        function closeConfigWheelConfirm() {
            const modal = document.getElementById('configWheelConfirmModal');
            modal.classList.remove('show');
        }
        
        function confirmSaveWheelConfig() {
            // 这里可以添加实际的保存配置逻辑
            console.log('保存转盘配置:', wheelConfigData);
            
            // 模拟保存成功
            alert('转盘配置保存成功！');
            
            // 关闭确认弹窗和配置模态框
            closeConfigWheelConfirm();
            closeConfigWheelModal();
        }
        
        // 删除配置项函数
        function deleteConfigItem(index) {
            if (index === 0) {
                // 第一行不允许删除
                return;
            }
            
            // 弹窗确认删除
            if (confirm('确定要删除这个配置项吗？')) {
                // 从数组中删除指定项
                wheelConfigData.splice(index, 1);
                
                // 重新排序
                wheelConfigData.forEach((item, newIndex) => {
                    item.order = newIndex + 1;
                });
                
                // 重新渲染表格
                renderWheelConfigTable();
            }
        }
        

        
        function resetAddActivityForm() {
            document.getElementById('addActivityForm').reset();
            // 重置图片上传区域
            document.getElementById('previewImage').style.display = 'none';
            document.getElementById('uploadText').style.display = 'block';
            // 重置单选下拉框
            document.getElementById('newInstitution').value = '';
            document.getElementById('newAssociatedBank').value = '';
        }
        
        // 模拟机构数据（实际项目中应该从后端获取）
        const institutionData = [
            { id: '10000001', name: '湖北银行' },
            { id: '10000002', name: '建设银行' },
            { id: '10000003', name: '工商银行' },
            { id: '10000004', name: '农业银行' },
            { id: '10000005', name: '中国银行' },
            { id: '10000006', name: '招商银行' },
            { id: '10000007', name: '交通银行' },
            { id: '10000008', name: '中信银行' },
            { id: '10000009', name: '光大银行' },
            { id: '10000010', name: '华夏银行' }
        ];
        
        // 机构搜索功能
        function searchInstitutions(keyword) {
            const optionsContainer = document.getElementById('institutionOptions');
            
            if (!keyword) {
                optionsContainer.style.display = 'none';
                return;
            }
            
            const filteredInstitutions = institutionData.filter(inst => 
                inst.id.includes(keyword) || inst.name.includes(keyword)
            );
            
            if (filteredInstitutions.length > 0) {
                let optionsHTML = '';
                filteredInstitutions.forEach(inst => {
                    optionsHTML += `<div class="institution-option" data-id="${inst.id}" style="padding: 8px 12px; cursor: pointer; border-bottom: 1px solid #f0f0f0;" onmouseover="this.style.backgroundColor='#f5f7fa'" onmouseout="this.style.backgroundColor='white'">${inst.name} (${inst.id})</div>`;
                });
                optionsContainer.innerHTML = optionsHTML;
                optionsContainer.style.display = 'block';
                
                // 为每个选项添加点击事件
                document.querySelectorAll('.institution-option').forEach(option => {
                    option.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        const name = this.textContent;
                        document.getElementById('newInstitution').value = id;
                        document.getElementById('institutionSearch').value = name;
                        optionsContainer.style.display = 'none';
                    });
                });
            } else {
                optionsContainer.innerHTML = '<div style="padding: 8px 12px; color: #909399;">未找到匹配的机构</div>';
                optionsContainer.style.display = 'block';
            }
        }
        
        // 图片上传处理
        function handleImageUpload() {
            const fileInput = document.getElementById('imageUpload');
            const previewImage = document.getElementById('previewImage');
            const uploadText = document.getElementById('uploadText');
            
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                    uploadText.style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        }
        
        // 查看商户相关函数
        function searchMerchants() {
            const merchantId = document.getElementById('merchantId').value;
            console.log('搜索商户:', merchantId);
            // 这里可以添加实际的搜索逻辑
            // 例如发送AJAX请求到后端获取匹配的商户
        }

        function resetMerchantSearch() {
            document.getElementById('merchantId').value = '';
            console.log('重置商户搜索');
            // 这里可以添加重置商户列表的逻辑
        }

        function batchBindMerchants() {
            console.log('批量绑定商户');
            // 这里可以添加实际的批量绑定逻辑
            alert('批量绑定功能暂未实现');
        }

        function exportMerchants() {
            console.log('导出商户数据');
            // 这里可以添加实际的导出逻辑
            alert('导出功能暂未实现');
        }
        
        // 批次号搜索相关函数
        function searchBatches() {
            const batchId = document.getElementById('batchId').value;
            console.log('搜索批次:', batchId);
            // 这里可以添加实际的搜索逻辑
            // 例如发送AJAX请求到后端获取匹配的批次
            alert('批次搜索功能已触发，批次号: ' + batchId);
        }

        function resetBatchSearch() {
            document.getElementById('batchId').value = '';
            console.log('重置批次搜索');
            // 这里可以添加重置批次列表的逻辑
            alert('批次搜索已重置');
        }
        
        // 页面加载完成后绑定事件
        document.addEventListener('DOMContentLoaded', function() {
            // 控制启用转盘按钮的显示
            updateEnableWheelButtons();
            // 新增按钮事件
            const addActivityBtn = document.getElementById('addActivityBtn');
            if (addActivityBtn) {
                addActivityBtn.addEventListener('click', showAddActivityModal);
            }
            
            // 取消按钮事件
            const cancelAddActivity = document.getElementById('cancelAddActivity');
            if (cancelAddActivity) {
                cancelAddActivity.addEventListener('click', closeAddActivityModal);
            }
            
            // 提交按钮事件
            const submitAddActivity = document.getElementById('submitAddActivity');
            if (submitAddActivity) {
                submitAddActivity.addEventListener('click', submitAddActivityForm);
            }
            
            // 关闭按钮事件
            const closeAddActivityModalBtn = document.getElementById('closeAddActivityModal');
            if (closeAddActivityModalBtn) {
                closeAddActivityModalBtn.addEventListener('click', closeAddActivityModal);
            }
            
            // 编辑模态框相关事件
            const cancelEditActivity = document.getElementById('cancelEditActivity');
            if (cancelEditActivity) {
                cancelEditActivity.addEventListener('click', closeEditActivityModal);
            }
            
            const submitEditActivity = document.getElementById('submitEditActivity');
            if (submitEditActivity) {
                submitEditActivity.addEventListener('click', submitEditActivityForm);
            }
            
            const closeEditActivityModalBtn = document.getElementById('closeEditActivityModal');
            if (closeEditActivityModalBtn) {
                closeEditActivityModalBtn.addEventListener('click', closeEditActivityModal);
            }
            
            // 图片上传区域点击事件
            const imageUploadArea = document.getElementById('imageUploadArea');
            if (imageUploadArea) {
                imageUploadArea.addEventListener('click', function() {
                    const imageUpload = document.getElementById('imageUpload');
                    if (imageUpload) {
                        imageUpload.click();
                    }
                });
            }
            
            // 编辑图片上传区域点击事件
            const editImageUploadArea = document.getElementById('editImageUploadArea');
            if (editImageUploadArea) {
                editImageUploadArea.addEventListener('click', function() {
                    const editImageUpload = document.getElementById('editImageUpload');
                    if (editImageUpload) {
                        editImageUpload.click();
                    }
                });
            }
            
            // 文件选择变化事件
            const imageUpload = document.getElementById('imageUpload');
            if (imageUpload) {
                imageUpload.addEventListener('change', handleImageUpload);
            }
            
            // 编辑文件选择变化事件
            const editImageUpload = document.getElementById('editImageUpload');
            if (editImageUpload) {
                editImageUpload.addEventListener('change', function() {
                    const file = editImageUpload.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            document.getElementById('editPreviewImage').src = e.target.result;
                            document.getElementById('editPreviewImage').style.display = 'block';
                            document.getElementById('editUploadText').style.display = 'none';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            // 机构搜索事件
            const institutionSearch = document.getElementById('institutionSearch');
            if (institutionSearch) {
                institutionSearch.addEventListener('input', function() {
                    searchInstitutions(this.value);
                });
            }
            
            // 点击其他地方隐藏搜索结果
            document.addEventListener('click', function(event) {
                const searchContainer = document.getElementById('institutionSearch') ? document.getElementById('institutionSearch').parentElement : null;
                if (searchContainer && !searchContainer.contains(event.target)) {
                    const institutionOptions = document.getElementById('institutionOptions');
                    if (institutionOptions) {
                        institutionOptions.style.display = 'none';
                    }
                }
            });


            // 注意：函数定义应该在全局作用域中，这里只是事件绑定

            
            // 查看模态框标签页切换事件
            const viewModal = document.getElementById('viewActivityModal');
            if (viewModal) {
                const viewTabItems = viewModal.querySelectorAll('.tab-item');
                viewTabItems.forEach(item => {
                    item.addEventListener('click', function() {
                        // 移除查看模态框内所有标签页的active类
                        viewTabItems.forEach(tab => tab.classList.remove('active'));
                        
                        // 为当前点击的标签页添加active类
                        this.classList.add('active');
                        
                        // 隐藏查看模态框内所有内容面板
                        const viewTabPanes = viewModal.querySelectorAll('.tab-pane');
                        viewTabPanes.forEach(pane => pane.classList.remove('active'));
                        
                        // 显示对应的内容面板
                        const tabId = this.getAttribute('data-tab');
                        const contentPane = viewModal.querySelector(`#${tabId}-content`);
                        if (contentPane) {
                            contentPane.classList.add('active');
                        }
                    });
                });
            }
            
            // 报名机构模态框关闭按钮事件
            const closeInstitutionModalBtn = document.getElementById('closeInstitutionModal');
            if (closeInstitutionModalBtn) {
                closeInstitutionModalBtn.addEventListener('click', closeInstitutionModal);
            }
            
            // 点击模态框外部关闭模态框（延迟绑定以避免事件冲突）
            setTimeout(function() {
                document.addEventListener('click', function(event) {
                    const viewModal = document.getElementById('viewActivityModal');
                    const addModal = document.getElementById('addActivityModal');
                    const editModal = document.getElementById('editActivityModal');
                    const institutionModal = document.getElementById('institutionModal');
                    const bankModal = document.getElementById('bankModal');
                    
                    // 检查是否是查看详情按钮的点击
                    const isDetailButton = event.target.closest('.action-link') && 
                                         event.target.textContent.includes('查看详情');
                    
                    // 检查是否是编辑按钮的点击
                    const isEditButton = event.target.closest('.action-link') && 
                                        event.target.textContent.includes('编辑');
                    
                    // 如果是详情按钮或编辑按钮点击，不执行关闭逻辑
                    if (isDetailButton || isEditButton) {
                        return;
                    }
                    
                    // 检查点击是否在查看模态框外部
                    if (viewModal && viewModal.classList.contains('show') && 
                        !viewModal.contains(event.target)) {
                        closeViewActivityModal();
                    }
                    
                    // 检查点击是否在新增模态框外部
                    if (addModal && addModal.classList.contains('show') && 
                        !addModal.contains(event.target)) {
                        closeAddActivityModal();
                    }
                    
                    // 检查点击是否在编辑模态框外部
                    if (editModal && editModal.classList.contains('show') && 
                        !editModal.contains(event.target)) {
                        closeEditActivityModal();
                    }
                    
                    // 检查点击是否在报名机构模态框外部
                    if (institutionModal && institutionModal.classList.contains('show') && 
                        !institutionModal.contains(event.target)) {
                        closeInstitutionModal();
                    }
                    
                    // 检查点击是否在银行模态框外部
                    if (bankModal && bankModal.style.display !== 'none' && 
                        !bankModal.contains(event.target)) {
                        closeBankModal();
                    }
                    
                    // 检查点击是否在配置转盘模态框外部
                    const configWheelModal = document.getElementById('configWheelModal');
                    if (configWheelModal && configWheelModal.classList.contains('show') && 
                        !configWheelModal.contains(event.target)) {
                        closeConfigWheelModal();
                    }
                });
            }, 100);
            
            // URL参数处理 - 根据参数自动打开对应的模态框
            const urlParams = new URLSearchParams(window.location.search);
            const action = urlParams.get('action');
            const id = urlParams.get('id');
            
            // 延迟执行，确保页面完全加载
            setTimeout(function() {
                switch(action) {
                    case 'add':
                        showAddActivityModal();
                        break;
                    case 'edit':
                        if (id) {
                            showEditActivityModal(id);
                        }
                        break;
                    case 'view':
                        if (id) {
                            showViewActivityModal();
                        }
                        break;
                    case 'wheel':
                        if (id) {
                            showConfigWheelModal(id, null);
                        }
                        break;
                    case 'institution':
                        if (id) {
                            showInstitutionModal(id);
                        }
                        break;
                    case 'bank':
                        if (id) {
                            showBankModal(id);
                        }
                        break;
                }
            }, 500);
        });
        
        // 控制开启转盘和配置转盘按钮的显示逻辑
        function updateEnableWheelButtons() {
            // 获取所有数据行
            const rows = document.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                // 确保行有足够的单元格
                if (row.cells.length < 14) return;
                
                // 获取状态列和是否开启转盘列的内容
                // 根据表格结构调整列索引
                const statusCell = row.cells[12]; // 状态列
                const enableWheelCell = row.cells[11]; // 是否开启转盘列
                const actionCell = row.cells[13]; // 操作列
                
                // 检查状态和转盘开启状态
                const isActive = statusCell.textContent.trim() === '生效中';
                const isWheelEnabled = enableWheelCell.textContent.trim() === '是';
                const isWheelDisabled = enableWheelCell.textContent.trim() === '否';
                
                // 查找开启转盘按钮和配置转盘按钮
                const enableWheelButton = actionCell.querySelector('a[onclick*="showEnableWheelConfirm"]');
                const configWheelButton = actionCell.querySelector('a[onclick*="showConfigWheelModal"]');
                
                // 根据条件显示或隐藏开启转盘按钮
                if (enableWheelButton) {
                    if (isActive && isWheelDisabled) {
                        enableWheelButton.style.display = 'inline'; // 显示开启转盘按钮
                    } else {
                        enableWheelButton.style.display = 'none'; // 隐藏开启转盘按钮
                    }
                }
                
                // 根据条件显示或隐藏配置转盘按钮
                if (configWheelButton) {
                    if (isActive && isWheelEnabled) {
                        configWheelButton.style.display = 'inline'; // 显示配置转盘按钮
                    } else {
                        configWheelButton.style.display = 'none'; // 隐藏配置转盘按钮
                    }
                }
            });
        }
        
        // 查看活动详情相关函数
        function showViewActivityModal() {
            console.log('Attempting to show view activity modal');
            const modal = document.getElementById('viewActivityModal');
            console.log('View activity modal element:', modal);
            if (modal) {
                // 添加一个微小的延迟，确保DOM更新完成
                setTimeout(() => {
                    modal.classList.add('show');
                    console.log('View activity modal shown');
                }, 10);
            } else {
                console.log('View activity modal not found');
            }
        }
        
        function closeViewActivityModal() {
            const modal = document.getElementById('viewActivityModal');
            if (modal) {
                modal.classList.remove('show');
            }
        }

        // 页面跳转函数
        function navigateToPage(pageName) {
            window.location.href = pageName;
        }

        // 切换子菜单
        function toggleSubmenu(element) {
            const submenu = element.nextElementSibling;
            const arrow = element.querySelector('.menu-arrow');
            
            if (submenu && submenu.classList.contains('show')) {
                submenu.classList.remove('show');
                if (arrow) arrow.classList.remove('expanded');
            } else if (submenu) {
                submenu.classList.add('show');
                if (arrow) arrow.classList.add('expanded');
            }
        }

        // 标签页功能 - 简化版，主要用于页面跳转
        function switchTab(tabElement) {
            // 移除所有标签页的active状态
            const allTabs = document.querySelectorAll('.tab-item');
            allTabs.forEach(tab => tab.classList.remove('active'));
            
            // 为当前标签页添加active状态
            tabElement.classList.add('active');
            
            console.log('切换到标签页：', tabElement.querySelector('span').textContent);
        }

        // 报名机构管理相关函数
        function showInstitutionModal(activityId) {
            console.log('显示报名机构管理模态框，活动ID:', activityId);
            
            // 延迟执行以避免事件冲突
            setTimeout(function() {
                const modal = document.getElementById('institutionModal');
                console.log('找到的模态框元素:', modal);
                
                if (modal) {
                    // 根据活动ID加载对应的机构数据
                    loadInstitutionData(activityId);
                    
                    // 使用与testModal相同的强力样式设置
                    modal.style.display = 'flex';
                    modal.style.position = 'fixed';
                    modal.style.top = '0';
                    modal.style.right = '0';
                    modal.style.width = '800px';
                    modal.style.height = '100vh';
                    modal.style.backgroundColor = 'white';
                    modal.style.zIndex = '99999';
                    modal.style.transform = 'translateX(0)';
                    modal.style.boxShadow = '-2px 0 8px rgba(0, 0, 0, 0.3)';
                    modal.style.flexDirection = 'column';
                    
                    // 添加show类
                    modal.classList.add('show');
                    console.log('✅ 报名机构管理模态框已显示（延迟执行）');
                    
                } else {
                    console.error('❌ 未找到ID为institutionModal的模态框元素');
                }
            }, 50); // 50ms延迟，确保点击事件处理完成
        }

        function closeInstitutionModal() {
            const modal = document.getElementById('institutionModal');
            if (modal) {
                modal.classList.remove('show');
                
                // 重置所有强制设置的样式
                modal.style.display = '';
                modal.style.position = '';
                modal.style.top = '';
                modal.style.right = '';
                modal.style.width = '';
                modal.style.height = '';
                modal.style.backgroundColor = '';
                modal.style.zIndex = '';
                modal.style.transform = '';
                modal.style.boxShadow = '';
                modal.style.flexDirection = '';
                modal.style.border = ''; // 清除调试时可能添加的边框
                
                console.log('✅ 报名机构管理模态框已关闭');
            }
        }

        // 加载机构数据（根据活动ID）
        function loadInstitutionData(activityId) {
            // 这里可以根据activityId从后端获取该活动的报名机构数据
            // 示例数据
            const institutionData = [
                {
                    id: 1,
                    institutionId: '10000001',
                    institutionName: '湖北银行',
                    registerTime: '2025-07-30 15:02:56',
                    operator: '曹政'
                },
                {
                    id: 2,
                    institutionId: '10000003',
                    institutionName: '中国工商银行',
                    registerTime: '2025-08-01 14:30:45',
                    operator: '王芳'
                },
                {
                    id: 3,
                    institutionId: '10000005',
                    institutionName: '中国银行',
                    registerTime: '2025-08-05 11:20:33',
                    operator: '刘强'
                },
                {
                    id: 4,
                    institutionId: '10000007',
                    institutionName: '中国建设银行',
                    registerTime: '2025-08-06 09:15:22',
                    operator: '张伟'
                },
                {
                    id: 5,
                    institutionId: '10000009',
                    institutionName: '招商银行',
                    registerTime: '2025-08-08 16:45:18',
                    operator: '李明'
                },
                {
                    id: 6,
                    institutionId: '10000011',
                    institutionName: '中国农业银行',
                    registerTime: '2025-08-10 10:30:44',
                    operator: '陈丽'
                },
                {
                    id: 7,
                    institutionId: '10000013',
                    institutionName: '交通银行',
                    registerTime: '2025-08-12 13:25:37',
                    operator: '赵磊'
                },
                {
                    id: 8,
                    institutionId: '10000015',
                    institutionName: '中信银行',
                    registerTime: '2025-08-14 08:55:12',
                    operator: '孙莉'
                },
                {
                    id: 9,
                    institutionId: '10000017',
                    institutionName: '光大银行',
                    registerTime: '2025-08-16 12:10:58',
                    operator: '周杰'
                },
                {
                    id: 10,
                    institutionId: '10000019',
                    institutionName: '华夏银行',
                    registerTime: '2025-08-18 17:35:26',
                    operator: '吴敏'
                }
            ];
            
            // 更新表格数据
            updateInstitutionTable(institutionData);
        }

        // 更新机构表格数据
        function updateInstitutionTable(data) {
            const tbody = document.getElementById('institutionTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            data.forEach((item, index) => {
                const row = `
                    <tr>
                        <td class="checkbox-col" style="text-align: center;">
                            <input type="checkbox" class="institution-checkbox" value="${item.institutionId}" title="选择行" onchange="updateSelectAllInstitutions()">
                        </td>
                        <td>${index + 1}</td>
                        <td>${item.institutionId}</td>
                        <td>${item.institutionName}</td>
                        <td>${item.registerTime}</td>
                        <td>${item.operator}</td>
                        <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                            <a href="#" class="action-link" onclick="deleteInstitution(this, '${item.institutionId}')" style="color: #f56c6c;">删除</a>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // 全选/取消全选机构
        function toggleSelectAllInstitutions() {
            const selectAllCheckbox = document.getElementById('selectAllInstitutions');
            const institutionCheckboxes = document.querySelectorAll('.institution-checkbox');
            
            institutionCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
        }

        // 更新全选状态
        function updateSelectAllInstitutions() {
            const selectAllCheckbox = document.getElementById('selectAllInstitutions');
            const institutionCheckboxes = document.querySelectorAll('.institution-checkbox');
            const checkedCheckboxes = document.querySelectorAll('.institution-checkbox:checked');
            
            selectAllCheckbox.checked = institutionCheckboxes.length === checkedCheckboxes.length;
        }

        // 批量删除机构
        function batchDeleteInstitutions() {
            const checkedCheckboxes = document.querySelectorAll('.institution-checkbox:checked');
            
            if (checkedCheckboxes.length === 0) {
                alert('请先选择要删除的机构！');
                return;
            }
            
            const institutionIds = Array.from(checkedCheckboxes).map(cb => cb.value);
            const confirmMessage = `确定要删除选中的 ${checkedCheckboxes.length} 个机构吗？删除后将无法恢复。`;
            
            if (confirm(confirmMessage)) {
                console.log('批量删除机构:', institutionIds);
                
                // 这里可以添加实际的批量删除逻辑
                // 例如发送AJAX请求到后端
                
                // 模拟删除成功，移除表格行
                checkedCheckboxes.forEach(checkbox => {
                    const row = checkbox.closest('tr');
                    if (row) {
                        row.remove();
                    }
                });
                
                // 重置全选状态
                document.getElementById('selectAllInstitutions').checked = false;
                
                alert(`成功删除 ${checkedCheckboxes.length} 个机构！`);
            }
        }

        // 重置机构筛选
        function resetInstitutionFilter() {
            document.getElementById('filterInstitutionId').value = '';
            document.getElementById('filterInstitutionName').value = '';
            console.log('重置机构筛选条件');
        }

        // 搜索机构
        function searchInstitutions() {
            const institutionId = document.getElementById('filterInstitutionId').value;
            const institutionName = document.getElementById('filterInstitutionName').value;
            
            console.log('搜索机构:', { institutionId, institutionName });
            
            // 这里可以添加实际的搜索逻辑
            // 示例：根据筛选条件过滤数据
            alert('机构搜索功能已触发');
        }

        // 新增机构
        function addInstitution() {
            const select = document.getElementById('institutionSelect');
            const selectedValue = select.value;
            
            if (!selectedValue) {
                alert('请先选择要添加的机构！');
                return;
            }
            
            const selectedText = select.options[select.selectedIndex].text;
            console.log('新增机构:', selectedText);
            
            // 这里可以添加实际的新增逻辑
            // 例如发送AJAX请求到后端
            
            // 模拟添加成功
            alert('机构添加成功：' + selectedText);
            
            // 重置选择框
            select.value = '';
            
            // 重新加载数据（示例）
            // loadInstitutionData(currentActivityId);
        }

        // 批量导入机构
        function batchImportInstitutions() {
            console.log('批量导入机构');
            
            // 创建文件选择器
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.xlsx,.xls,.csv';
            
            fileInput.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    console.log('选择的文件:', file.name);
                    // 这里可以添加实际的文件处理逻辑
                    alert('批量导入功能暂未实现，选择的文件：' + file.name);
                }
            };
            
            fileInput.click();
        }

        // 删除机构
        function deleteInstitution(element, institutionId) {
            if (confirm('确定要删除此机构吗？')) {
                console.log('删除机构:', institutionId);
                
                // 这里可以添加实际的删除逻辑
                // 例如发送AJAX请求到后端
                
                // 模拟删除成功，移除表格行
                const row = element.closest('tr');
                if (row) {
                    row.remove();
                    alert('机构删除成功！');
                }
            }
        }


        
        // 导出活动数据
        function exportActivities() {
            console.log('导出活动数据');
            alert('导出功能暂未实现');
        }

        // 打开新增活动模态框
        function openAddActivityModal() {
            showAddActivityModal();
        }

        // 报名机构选择相关函数已移除（改为单选下拉框）

        // 关联银行选择相关函数已移除（改为单选下拉框）

        // 多选相关函数已移除（改为单选下拉框）
        // - getSelectedInstitutionsAndBanks
        // - resetSelectors

        // ===== 编辑模态框的选择器函数已移除（改为单选下拉框） =====

        // 多选相关函数已移除（改为单选下拉框）
        // - getSelectedInstitutionsAndBanksEdit
        // - resetSelectorsEdit  
        // - loadEditData

        // ===== 银行模态框管理函数 =====
        
        // 显示银行管理模态框
        function showBankModal(activityId) {
            console.log('显示关联银行管理模态框，活动ID:', activityId);
            const modal = document.getElementById('bankModal');
            console.log('找到的银行模态框元素:', modal);
            
            if (modal) {
                // 加载银行数据
                loadBankData(activityId);
                
                // 延迟显示防止事件冲突
                setTimeout(() => {
                    // 强制设置显示样式
                    modal.style.cssText = `
                        display: flex !important;
                        position: fixed !important;
                        top: 0 !important;
                        right: 0 !important;
                        width: 800px !important;
                        height: 100vh !important;
                        background-color: white !important;
                        z-index: 99999 !important;
                        transform: translateX(0) !important;
                        box-shadow: -2px 0 8px rgba(0, 0, 0, 0.3) !important;
                        flex-direction: column !important;
                    `;
                    console.log('✅ 关联银行管理模态框已显示');
                }, 50);
            } else {
                console.error('❌ 找不到银行模态框元素');
            }
        }

        // 关闭银行管理模态框
        function closeBankModal() {
            const modal = document.getElementById('bankModal');
            if (modal) {
                modal.style.cssText = '';
                modal.style.display = 'none';
                console.log('✅ 关联银行管理模态框已关闭');
            }
        }

        // 加载银行数据
        function loadBankData(activityId) {
            // 模拟不同活动的银行数据（每个活动10条银行数据）
            const bankDataPool = [
                { id: '20100001', name: '中国工商银行', time: '2025-07-30 15:02:56', operator: '曹政' },
                { id: '20100002', name: '中国银行', time: '2025-08-01 09:00:00', operator: '李明' },
                { id: '20100003', name: '中国建设银行', time: '2025-08-01 14:30:45', operator: '王芳' },
                { id: '20100004', name: '中国农业银行', time: '2025-08-02 11:15:22', operator: '张伟' },
                { id: '20100005', name: '招商银行', time: '2025-08-03 16:45:18', operator: '刘强' },
                { id: '20100006', name: '交通银行', time: '2025-08-04 10:30:44', operator: '陈丽' },
                { id: '20100007', name: '中信银行', time: '2025-08-05 13:25:37', operator: '赵磊' },
                { id: '20100008', name: '光大银行', time: '2025-08-06 08:55:12', operator: '孙莉' },
                { id: '20100009', name: '华夏银行', time: '2025-08-07 12:10:58', operator: '周杰' },
                { id: '20100010', name: '民生银行', time: '2025-08-08 17:35:26', operator: '吴敏' },
                { id: '20100011', name: '兴业银行', time: '2025-08-09 09:20:33', operator: '马超' },
                { id: '20100012', name: '浦发银行', time: '2025-08-10 14:45:17', operator: '林娜' },
                { id: '20100013', name: '广发银行', time: '2025-08-11 11:30:42', operator: '黄强' },
                { id: '20100014', name: '平安银行', time: '2025-08-12 16:15:28', operator: '田丽' },
                { id: '20100015', name: '湖北银行', time: '2025-08-13 10:05:36', operator: '何伟' }
            ];

            // 根据活动ID生成不同的银行组合
            const activityIdNum = parseInt(activityId.slice(-2));
            const startIndex = (activityIdNum * 3) % bankDataPool.length;
            const bankData = [];
            
            for (let i = 0; i < 10; i++) {
                const index = (startIndex + i) % bankDataPool.length;
                bankData.push({
                    ...bankDataPool[index],
                    time: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleString('zh-CN', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: false
                    }).replace(/\//g, '-')
                });
            }

            updateBankTable(bankData);
            console.log('已加载银行数据:', bankData);
        }

        // 更新银行表格
        function updateBankTable(data) {
            const tbody = document.getElementById('bankTableBody');
            tbody.innerHTML = '';

            data.forEach((bank, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-col" style="text-align: center;">
                        <input type="checkbox" class="bank-checkbox" value="${bank.id}" title="选择行" onchange="updateSelectAllBanks()">
                    </td>
                    <td>${index + 1}</td>
                    <td>${bank.id}</td>
                    <td>${bank.name}</td>
                    <td>${bank.time}</td>
                    <td>${bank.operator}</td>
                    <td class="action-col" style="position: sticky; right: 0; background-color: white; z-index: 5; box-shadow: -2px 0 4px rgba(0,0,0,0.1); text-align: center;">
                        <a href="#" class="action-link" onclick="deleteBank(this, '${bank.id}')" style="color: #f56c6c;">删除</a>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // 更新统计信息
            const infoElement = document.querySelector('#bankModal .pagination-info');
            if (infoElement) {
                infoElement.textContent = `共 ${data.length} 条`;
            }
        }

        // 重置银行筛选
        function resetBankFilter() {
            document.getElementById('filterBankCode').value = '';
            document.getElementById('filterBankName').value = '';
            console.log('银行筛选条件已重置');
        }

        // 搜索银行
        function searchBanks() {
            const bankCode = document.getElementById('filterBankCode').value;
            const bankName = document.getElementById('filterBankName').value;
            console.log('搜索银行:', { bankCode, bankName });
            // 这里可以实现实际的搜索逻辑
        }

        // 添加银行
        function addBank() {
            const select = document.getElementById('bankSelect');
            const selectedValue = select.value;
            const selectedText = select.options[select.selectedIndex].text;
            
            if (!selectedValue) {
                alert('请先选择一个银行！');
                return;
            }
            
            console.log('添加银行:', { value: selectedValue, text: selectedText });
            // 这里可以实现实际的添加逻辑
            alert('银行添加功能暂未实现');
        }

        // 删除银行
        function deleteBank(element, bankCode) {
            if (confirm('确定要删除这个银行吗？')) {
                const row = element.closest('tr');
                row.remove();
                console.log('删除银行:', bankCode);
                
                // 更新统计信息
                const tbody = document.getElementById('bankTableBody');
                const remainingRows = tbody.querySelectorAll('tr').length;
                const infoElement = document.querySelector('#bankModal .pagination-info');
                if (infoElement) {
                    infoElement.textContent = `共 ${remainingRows} 条`;
                }
            }
        }

        // 全选/取消全选银行
        function toggleSelectAllBanks() {
            const selectAllCheckbox = document.getElementById('selectAllBanks');
            const bankCheckboxes = document.querySelectorAll('.bank-checkbox');
            
            bankCheckboxes.forEach(checkbox => {
                checkbox.checked = selectAllCheckbox.checked;
            });
            
            console.log('银行全选状态:', selectAllCheckbox.checked);
        }

        // 更新全选状态
        function updateSelectAllBanks() {
            const selectAllCheckbox = document.getElementById('selectAllBanks');
            const bankCheckboxes = document.querySelectorAll('.bank-checkbox');
            const checkedBoxes = document.querySelectorAll('.bank-checkbox:checked');
            
            if (checkedBoxes.length === 0) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = false;
            } else if (checkedBoxes.length === bankCheckboxes.length) {
                selectAllCheckbox.indeterminate = false;
                selectAllCheckbox.checked = true;
            } else {
                selectAllCheckbox.indeterminate = true;
            }
        }

        // 批量删除银行
        function batchDeleteBanks() {
            const checkedBoxes = document.querySelectorAll('.bank-checkbox:checked');
            if (checkedBoxes.length === 0) {
                alert('请先选择要删除的银行！');
                return;
            }
            
            if (confirm(`确定要删除选中的 ${checkedBoxes.length} 个银行吗？`)) {
                checkedBoxes.forEach(checkbox => {
                    const row = checkbox.closest('tr');
                    row.remove();
                });
                
                // 更新统计信息
                const tbody = document.getElementById('bankTableBody');
                const remainingRows = tbody.querySelectorAll('tr').length;
                const infoElement = document.querySelector('#bankModal .pagination-info');
                if (infoElement) {
                    infoElement.textContent = `共 ${remainingRows} 条`;
                }
                
                console.log('批量删除银行完成');
            }
        }

        // 批量导入银行
        function batchImportBanks() {
            console.log('批量导入银行');
            // 创建文件输入
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.xlsx,.xls,.csv';
            fileInput.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    console.log('选择的文件:', file.name);
                    alert('批量导入功能暂未实现');
                }
            };
            fileInput.click();
        }

        // 调试函数 - 直接测试模态框显示
        function testModal() {
            console.log('=== 模态框测试开始 ===');
            const modal = document.getElementById('institutionModal');
            console.log('1. 模态框元素:', modal);
            
            if (!modal) {
                console.error('❌ 模态框元素未找到');
                return;
            }
            
            console.log('2. 模态框初始状态:', {
                display: modal.style.display,
                classList: modal.classList.toString()
            });
            
            // 强制显示
            modal.style.display = 'flex';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.right = '0';
            modal.style.width = '800px';
            modal.style.height = '100vh';
            modal.style.backgroundColor = 'white';
            modal.style.zIndex = '99999';
            modal.style.transform = 'translateX(0)';
            modal.style.border = '3px solid red'; // 调试用红边框
            
            modal.classList.add('show');
            
            console.log('3. 强制显示后状态:', {
                display: modal.style.display,
                transform: modal.style.transform,
                zIndex: modal.style.zIndex,
                classList: modal.classList.toString()
            });
            
            console.log('✅ 模态框应该现在可见了（带红色边框）');
            console.log('如果还看不到，请检查浏览器窗口右侧');
        }

        // 将测试函数暴露到全局，方便在控制台调用
        window.testModal = testModal;
        window.showInstitutionModal = showInstitutionModal;
        window.closeInstitutionModal = closeInstitutionModal;
        
        // 页面加载完成后绑定事件
        document.addEventListener('DOMContentLoaded', function() {
            // 更新开启转盘按钮状态
            updateEnableWheelButtons();
            
            // 初始化转盘配置数据
            const mockData = [
                { 
                    order: 1, 
                    content: '招行信用卡优惠活动 ID: ACT001\n20250101 - 20250331', 
                    color: '#FF6B6B', 
                    weight: 20 
                },
                { 
                    order: 2, 
                    content: '招行理财产品推广 ID: ACT002\n20250201 - 20250430', 
                    color: '#4ECDC4', 
                    weight: 25 
                },
                { 
                    order: 3, 
                    content: '招行手机银行活动 ID: ACT003\n20250301 - 20250531', 
                    color: '#45B7D1', 
                    weight: 30 
                },
                { 
                    order: 4, 
                    content: '招行餐饮优惠活动 ID: ACT004\n20250401 - 20250630', 
                    color: '#96CEB4', 
                    weight: 25 
                }
            ];
            
            if (typeof wheelConfigData === 'undefined') {
                window.wheelConfigData = [];
            }
            wheelConfigData = mockData;
            
            // 渲染转盘配置表格
            if (typeof renderWheelConfigTable === 'function') {
                renderWheelConfigTable();
            }
            
            // 绑定配置转盘模态框关闭按钮
            const closeConfigBtn = document.getElementById('closeConfigWheelModal');
            if (closeConfigBtn) {
                closeConfigBtn.addEventListener('click', closeConfigWheelModal);
            }
            
            // 绑定确定按钮
            const confirmConfigBtn = document.getElementById('confirmConfigWheel');
            if (confirmConfigBtn) {
                confirmConfigBtn.addEventListener('click', showConfigWheelConfirm);
            }
            
            // 绑定模态框外部点击事件
            bindModalOutsideClick();
            
            // 初始化颜色选择器
            initColorPicker();
            

        });
        
        // 初始化颜色选择器
        function initColorPicker() {
            const colorItems = document.querySelectorAll('.color-item');
            colorItems.forEach(item => {
                item.addEventListener('click', function() {
                    // 清除其他选中状态
                    document.querySelectorAll('.color-item').forEach(colorItem => {
                        colorItem.classList.remove('selected');
                    });
                    // 设置当前选中
                    this.classList.add('selected');
                    // 更新自定义颜色输入框
                    const color = this.getAttribute('data-color');
                    document.getElementById('customColorInput').value = color;
                });
            });
        }
        
        // 绑定模态框外部点击事件
        function bindModalOutsideClick() {
            // 配置转盘模态框外部点击关闭
            const configModal = document.getElementById('configWheelModal');
            if (configModal) {
                configModal.addEventListener('click', function(e) {
                    if (e.target === configModal) {
                        closeConfigWheelModal();
                    }
                });
            }
            
            // 颜色选择器外部点击关闭
            const colorPickerOverlay = document.getElementById('colorPickerOverlay');
            if (colorPickerOverlay) {
                colorPickerOverlay.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeColorPicker();
                    }
                });
            }
        }
        
        // 下拉选择器功能函数
        
        // 机构下拉选择器功能
        function showInstitutionDropdown() {
            const dropdown = document.getElementById('institutionDropdown');
            dropdown.classList.add('show');
        }
        
        function hideInstitutionDropdown() {
            setTimeout(() => {
                const dropdown = document.getElementById('institutionDropdown');
                dropdown.classList.remove('show');
            }, 200);
        }
        
        function filterInstitutions(value) {
            const dropdown = document.getElementById('institutionDropdown');
            const items = dropdown.querySelectorAll('.dropdown-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const searchValue = value.toLowerCase();
                if (text.includes(searchValue)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            dropdown.classList.add('show');
        }
        
        function selectInstitution(value) {
            const input = document.getElementById('institution');
            input.value = value;
            const dropdown = document.getElementById('institutionDropdown');
            dropdown.classList.remove('show');
        }
        
        // 银行下拉选择器功能
        function showBankDropdown() {
            const dropdown = document.getElementById('bankDropdown');
            dropdown.classList.add('show');
        }
        
        function hideBankDropdown() {
            setTimeout(() => {
                const dropdown = document.getElementById('bankDropdown');
                dropdown.classList.remove('show');
            }, 200);
        }
        
        function filterBanks(value) {
            const dropdown = document.getElementById('bankDropdown');
            const items = dropdown.querySelectorAll('.dropdown-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const searchValue = value.toLowerCase();
                if (text.includes(searchValue)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            dropdown.classList.add('show');
        }
        
        function selectBank(value) {
            const input = document.getElementById('associatedBank');
            input.value = value;
            const dropdown = document.getElementById('bankDropdown');
            dropdown.classList.remove('show');
        }
        
        // 编辑模态框的机构下拉选择器功能
        function showInstitutionDropdownEdit() {
            const dropdown = document.getElementById('editInstitutionDropdown');
            dropdown.classList.add('show');
        }
        
        function hideInstitutionDropdownEdit() {
            setTimeout(() => {
                const dropdown = document.getElementById('editInstitutionDropdown');
                dropdown.classList.remove('show');
            }, 200);
        }
        
        function filterInstitutionsEdit(value) {
            const dropdown = document.getElementById('editInstitutionDropdown');
            const items = dropdown.querySelectorAll('.dropdown-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const searchValue = value.toLowerCase();
                if (text.includes(searchValue)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            dropdown.classList.add('show');
        }
        
        function selectInstitutionEdit(value) {
            const input = document.getElementById('editInstitution');
            input.value = value;
            const dropdown = document.getElementById('editInstitutionDropdown');
            dropdown.classList.remove('show');
        }
        
        // 编辑模态框的银行下拉选择器功能
        function showBankDropdownEdit() {
            const dropdown = document.getElementById('editBankDropdown');
            dropdown.classList.add('show');
        }
        
        function hideBankDropdownEdit() {
            setTimeout(() => {
                const dropdown = document.getElementById('editBankDropdown');
                dropdown.classList.remove('show');
            }, 200);
        }
        
        function filterBanksEdit(value) {
            const dropdown = document.getElementById('editBankDropdown');
            const items = dropdown.querySelectorAll('.dropdown-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                const searchValue = value.toLowerCase();
                if (text.includes(searchValue)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
            
            dropdown.classList.add('show');
        }
        
        function selectBankEdit(value) {
            const input = document.getElementById('editAssociatedBank');
            input.value = value;
            const dropdown = document.getElementById('editBankDropdown');
            dropdown.classList.remove('show');
        }
    </script>
    
    <!-- 配置转盘滑出模态框 -->
    <div class="slide-modal" id="configWheelModal">
        <div class="slide-modal-header">
            <h3>配置转盘</h3>
            <button class="slide-modal-close" id="closeConfigWheelModal">&times;</button>
        </div>
        <div class="slide-modal-body">
            <div class="wheel-config-container">
                <div class="wheel-config-table">
                    <div class="table-wrapper">
                        <div class="scrollable-table">
                            <table class="config-table main-table">
                                <thead>
                                    <tr>
                                        <th>顺序</th>
                                        <th>转盘显示内容</th>
                                        <th>颜色</th>
                                        <th>权重</th>
                                        <th class="action-col">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="wheelConfigTableBody">
                                    <!-- 动态生成的配置项 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="wheel-config-actions">
                    <button type="button" class="btn-add-config" onclick="addWheelConfigItem()">+ 添加</button>
                </div>
            </div>
        </div>
        <div class="slide-modal-footer">
            <button type="button" class="btn-confirm" id="confirmConfigWheel" style="background-color: #4a90e2;">确定</button>
        </div>
    </div>
    
    <!-- 配置转盘确认弹窗 -->
    <div class="confirm-overlay" id="configWheelConfirmModal">
        <div class="confirm-dialog">
            <div class="confirm-header">
                <h4>确认保存配置</h4>
            </div>
            <div class="confirm-body">
                <p>确定要保存当前的转盘配置吗？</p>
            </div>
            <div class="confirm-footer">
                <button type="button" class="btn-cancel" onclick="closeConfigWheelConfirm()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmSaveWheelConfig()" style="background-color: #409eff;">确定保存</button>
            </div>
        </div>
    </div>
    
    <!-- 颜色选择器 -->
    <div class="color-picker-overlay" id="colorPickerOverlay" style="display: none;">
        <div class="color-picker-panel">
            <div class="color-picker-header">
                <h4>选择颜色</h4>
                <button class="color-picker-close" onclick="closeColorPicker()">&times;</button>
            </div>
            <div class="color-picker-body">
                <div class="color-palette">
                    <div class="color-item" data-color="#FF6B6B" style="background-color: #FF6B6B;"></div>
                    <div class="color-item" data-color="#4ECDC4" style="background-color: #4ECDC4;"></div>
                    <div class="color-item" data-color="#45B7D1" style="background-color: #45B7D1;"></div>
                    <div class="color-item" data-color="#96CEB4" style="background-color: #96CEB4;"></div>
                    <div class="color-item" data-color="#FFEAA7" style="background-color: #FFEAA7;"></div>
                    <div class="color-item" data-color="#DDA0DD" style="background-color: #DDA0DD;"></div>
                    <div class="color-item" data-color="#98D8C8" style="background-color: #98D8C8;"></div>
                    <div class="color-item" data-color="#F7DC6F" style="background-color: #F7DC6F;"></div>
                    <div class="color-item" data-color="#BB8FCE" style="background-color: #BB8FCE;"></div>
                    <div class="color-item" data-color="#85C1E9" style="background-color: #85C1E9;"></div>
                </div>
                <div class="custom-color-input">
                    <label>自定义颜色：</label>
                    <input type="color" id="customColorInput" value="#FF6B6B">
                </div>
            </div>
            <div class="color-picker-footer">
                <button type="button" class="btn-cancel" onclick="closeColorPicker()">取消</button>
                <button type="button" class="btn-confirm" onclick="confirmColorSelection()" style="background-color: #409eff;">确定</button>
            </div>
        </div>
    </div>

</body>
</html>