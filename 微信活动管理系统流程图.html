<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微信活动管理系统业务流程图 - 可交互版本</title> - 业务流程图</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .flow-container {
            padding: 40px;
            background: #fafbfc;
        }

        .flow-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #e9ecef;
        }

        .flow-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 500;
            color: #6c757d;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .flow-tab.active {
            color: #4a90e2;
            border-bottom-color: #4a90e2;
        }

        .flow-tab:hover {
            color: #4a90e2;
        }

        .flow-content {
            display: none;
        }

        .flow-content.active {
            display: block;
        }

        .flow-svg {
            width: 100%;
            height: auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .flow-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .flow-node:hover .node-rect {
            stroke-width: 3;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .flow-node.active .node-rect {
            stroke: #4a90e2;
            stroke-width: 4;
        }

        .flow-arrow {
            stroke: #6c757d;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
            transition: all 0.3s ease;
        }

        .flow-arrow.active {
            stroke: #4a90e2;
            stroke-width: 3;
        }

        .decision-diamond {
            fill: #ffc107;
            stroke: #ff9800;
            stroke-width: 2;
        }

        .process-rect {
            fill: #28a745;
            stroke: #20c997;
            stroke-width: 2;
        }

        .start-end-ellipse {
            fill: #6f42c1;
            stroke: #6610f2;
            stroke-width: 2;
        }

        .data-rect {
            fill: #17a2b8;
            stroke: #138496;
            stroke-width: 2;
        }

        .flow-text {
            fill: white;
            font-size: 12px;
            font-weight: 500;
            text-anchor: middle;
            dominant-baseline: middle;
        }

        .flow-label {
            fill: #495057;
            font-size: 11px;
            text-anchor: middle;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .btn {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #357abd;
            transform: translateY(-2px);
        }

        .btn.secondary {
            background: #6c757d;
        }

        .btn.secondary:hover {
            background: #5a6268;
        }

        .flow-description {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .flow-description h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .flow-description p {
            color: #6c757d;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .flow-steps {
            list-style: none;
        }

        .flow-steps li {
            padding: 8px 0;
            border-left: 3px solid #4a90e2;
            padding-left: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 0 8px 8px 0;
        }

        .flow-steps li strong {
            color: #2c3e50;
        }

        .legend {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .legend-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .legend-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #5a6c7d;
        }

        .legend-shape {
            width: 30px;
            height: 20px;
            margin-right: 10px;
            border-radius: 4px;
        }

        .tooltip {
            position: absolute;
            background: #2c3e50;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .tooltip.show {
            opacity: 1;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #2c3e50;
        }

        @media (max-width: 768px) {
            .flow-container {
                padding: 20px;
            }
            
            .flow-tabs {
                flex-wrap: wrap;
            }
            
            .flow-tab {
                flex: 1;
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>微信活动管理系统业务流程图</h1>
            <p>基于HTML+SVG的交互式业务流程设计 | 点击节点查看详细说明</p>
        </div>

        <div class="flow-container">
            <!-- 流程标签页 -->
            <div class="flow-tabs">
                <button class="flow-tab active" onclick="showFlow('create')">活动创建流程</button>
                <button class="flow-tab" onclick="showFlow('query')">活动查询流程</button>
                <button class="flow-tab" onclick="showFlow('manage')">活动管理流程</button>
                <button class="flow-tab" onclick="showFlow('batch')">批量操作流程</button>
            </div>

            <!-- 控制按钮 -->
            <div class="controls">
                <button class="btn" onclick="animateFlow()">演示流程</button>
                <button class="btn secondary" onclick="resetFlow()">重置状态</button>
                <button class="btn" onclick="highlightCriticalPath()">关键路径</button>
            </div>

            <!-- 活动创建流程 -->
            <div class="flow-content active" id="create-flow">
                <svg class="flow-svg" viewBox="0 0 1200 800">
                    <!-- 定义箭头标记 -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#6c757d" />
                        </marker>
                        <marker id="arrowhead-active" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#4a90e2" />
                        </marker>
                    </defs>

                    <!-- 开始节点 -->
                    <g class="flow-node" data-step="start" onclick="highlightNode(this)">
                        <ellipse cx="100" cy="80" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="100" y="80" class="flow-text">开始</text>
                    </g>

                    <!-- 用户登录验证 -->
                    <g class="flow-node" data-step="login" onclick="highlightNode(this)">
                        <rect x="50" y="150" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="100" y="175" class="flow-text">用户登录验证</text>
                    </g>

                    <!-- 权限检查 -->
                    <g class="flow-node" data-step="permission" onclick="highlightNode(this)">
                        <polygon points="100,250 150,275 100,300 50,275" class="decision-diamond node-rect"/>
                        <text x="100" y="275" class="flow-text">权限检查</text>
                    </g>

                    <!-- 无权限提示 -->
                    <g class="flow-node" data-step="no-permission" onclick="highlightNode(this)">
                        <rect x="200" y="250" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="275" class="flow-text">无权限提示</text>
                    </g>

                    <!-- 打开新增弹窗 -->
                    <g class="flow-node" data-step="open-modal" onclick="highlightNode(this)">
                        <rect x="50" y="350" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="100" y="375" class="flow-text">打开新增弹窗</text>
                    </g>

                    <!-- 填写活动信息 -->
                    <g class="flow-node" data-step="fill-form" onclick="highlightNode(this)">
                        <rect x="200" y="350" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="250" y="375" class="flow-text">填写活动信息</text>
                    </g>

                    <!-- 表单验证 -->
                    <g class="flow-node" data-step="validate" onclick="highlightNode(this)">
                        <polygon points="250,450 300,475 250,500 200,475" class="decision-diamond node-rect"/>
                        <text x="250" y="475" class="flow-text">表单验证</text>
                    </g>

                    <!-- 验证失败 -->
                    <g class="flow-node" data-step="validate-fail" onclick="highlightNode(this)">
                        <rect x="350" y="450" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="475" class="flow-text">显示错误信息</text>
                    </g>

                    <!-- 提交数据 -->
                    <g class="flow-node" data-step="submit" onclick="highlightNode(this)">
                        <rect x="200" y="550" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="575" class="flow-text">提交数据</text>
                    </g>

                    <!-- API调用 -->
                    <g class="flow-node" data-step="api-call" onclick="highlightNode(this)">
                        <rect x="350" y="550" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="400" y="575" class="flow-text">API调用</text>
                    </g>

                    <!-- 保存结果判断 -->
                    <g class="flow-node" data-step="save-result" onclick="highlightNode(this)">
                        <polygon points="400,650 450,675 400,700 350,675" class="decision-diamond node-rect"/>
                        <text x="400" y="675" class="flow-text">保存成功?</text>
                    </g>

                    <!-- 保存失败 -->
                    <g class="flow-node" data-step="save-fail" onclick="highlightNode(this)">
                        <rect x="500" y="650" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="550" y="675" class="flow-text">保存失败提示</text>
                    </g>

                    <!-- 成功提示 -->
                    <g class="flow-node" data-step="success" onclick="highlightNode(this)">
                        <rect x="350" y="750" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="775" class="flow-text">成功提示</text>
                    </g>

                    <!-- 刷新列表 -->
                    <g class="flow-node" data-step="refresh" onclick="highlightNode(this)">
                        <rect x="500" y="750" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="550" y="775" class="flow-text">刷新列表</text>
                    </g>

                    <!-- 结束节点 -->
                    <g class="flow-node" data-step="end" onclick="highlightNode(this)">
                        <ellipse cx="650" cy="775" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="650" y="775" class="flow-text">结束</text>
                    </g>

                    <!-- 连接线 -->
                    <path class="flow-arrow" d="M100 110 L100 150" data-from="start" data-to="login"/>
                    <path class="flow-arrow" d="M100 200 L100 250" data-from="login" data-to="permission"/>
                    <path class="flow-arrow" d="M150 275 L200 275" data-from="permission" data-to="no-permission"/>
                    <path class="flow-arrow" d="M100 300 L100 350" data-from="permission" data-to="open-modal"/>
                    <path class="flow-arrow" d="M150 375 L200 375" data-from="open-modal" data-to="fill-form"/>
                    <path class="flow-arrow" d="M250 400 L250 450" data-from="fill-form" data-to="validate"/>
                    <path class="flow-arrow" d="M300 475 L350 475" data-from="validate" data-to="validate-fail"/>
                    <path class="flow-arrow" d="M250 500 L250 550" data-from="validate" data-to="submit"/>
                    <path class="flow-arrow" d="M300 575 L350 575" data-from="submit" data-to="api-call"/>
                    <path class="flow-arrow" d="M400 600 L400 650" data-from="api-call" data-to="save-result"/>
                    <path class="flow-arrow" d="M450 675 L500 675" data-from="save-result" data-to="save-fail"/>
                    <path class="flow-arrow" d="M400 700 L400 750" data-from="save-result" data-to="success"/>
                    <path class="flow-arrow" d="M450 775 L500 775" data-from="success" data-to="refresh"/>
                    <path class="flow-arrow" d="M600 775 L590 775" data-from="refresh" data-to="end"/>
                    
                    <!-- 返回循环线 -->
                    <path class="flow-arrow" d="M400 450 Q 480 400 300 375" data-from="validate-fail" data-to="fill-form" stroke-dasharray="5,5"/>
                    <path class="flow-arrow" d="M550 650 Q 580 600 250 550" data-from="save-fail" data-to="submit" stroke-dasharray="5,5"/>
                    <path class="flow-arrow" d="M300 275 Q 350 200 100 200" data-from="no-permission" data-to="login" stroke-dasharray="5,5"/>

                    <!-- 流程标签 -->
                    <text x="175" y="265" class="flow-label">无权限</text>
                    <text x="75" y="315" class="flow-label">有权限</text>
                    <text x="325" y="465" class="flow-label">验证失败</text>
                    <text x="225" y="515" class="flow-label">验证通过</text>
                    <text x="475" y="665" class="flow-label">失败</text>
                    <text x="375" y="715" class="flow-label">成功</text>
                </svg>

                <div class="flow-description">
                    <h3>🎯 活动创建流程说明</h3>
                    <p>该流程展示了用户创建新活动的完整业务流程，包含权限验证、表单填写、数据验证和保存等关键步骤。</p>
                    <ol class="flow-steps">
                        <li><strong>用户登录验证：</strong>确保用户身份合法性</li>
                        <li><strong>权限检查：</strong>验证用户是否有创建活动的权限</li>
                        <li><strong>打开新增弹窗：</strong>展示活动创建表单</li>
                        <li><strong>填写活动信息：</strong>用户输入活动相关数据</li>
                        <li><strong>表单验证：</strong>前端验证数据格式和业务规则</li>
                        <li><strong>提交数据：</strong>将验证通过的数据提交到后端</li>
                        <li><strong>API调用：</strong>后端处理数据并保存到数据库</li>
                        <li><strong>结果处理：</strong>根据保存结果给用户相应提示</li>
                    </ol>
                </div>
            </div>

            <!-- 活动查询流程 -->
            <div class="flow-content" id="query-flow">
                <svg class="flow-svg" viewBox="0 0 1200 600">
                    <!-- 开始节点 -->
                    <g class="flow-node" data-step="query-start" onclick="highlightNode(this)">
                        <ellipse cx="100" cy="80" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="100" y="80" class="flow-text">开始查询</text>
                    </g>

                    <!-- 输入查询条件 -->
                    <g class="flow-node" data-step="input-conditions" onclick="highlightNode(this)">
                        <rect x="50" y="150" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="100" y="175" class="flow-text">输入查询条件</text>
                    </g>

                    <!-- 条件验证 -->
                    <g class="flow-node" data-step="condition-validate" onclick="highlightNode(this)">
                        <polygon points="100,250 150,275 100,300 50,275" class="decision-diamond node-rect"/>
                        <text x="100" y="275" class="flow-text">条件验证</text>
                    </g>

                    <!-- 条件错误 -->
                    <g class="flow-node" data-step="condition-error" onclick="highlightNode(this)">
                        <rect x="200" y="250" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="275" class="flow-text">条件错误提示</text>
                    </g>

                    <!-- 构建查询参数 -->
                    <g class="flow-node" data-step="build-params" onclick="highlightNode(this)">
                        <rect x="50" y="350" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="100" y="375" class="flow-text">构建查询参数</text>
                    </g>

                    <!-- 发送API请求 -->
                    <g class="flow-node" data-step="send-request" onclick="highlightNode(this)">
                        <rect x="200" y="350" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="250" y="375" class="flow-text">发送API请求</text>
                    </g>

                    <!-- 检查缓存 -->
                    <g class="flow-node" data-step="check-cache" onclick="highlightNode(this)">
                        <polygon points="250,450 300,475 250,500 200,475" class="decision-diamond node-rect"/>
                        <text x="250" y="475" class="flow-text">检查缓存</text>
                    </g>

                    <!-- 使用缓存数据 -->
                    <g class="flow-node" data-step="use-cache" onclick="highlightNode(this)">
                        <rect x="350" y="450" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="475" class="flow-text">使用缓存数据</text>
                    </g>

                    <!-- 请求后端数据 -->
                    <g class="flow-node" data-step="fetch-data" onclick="highlightNode(this)">
                        <rect x="200" y="550" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="250" y="575" class="flow-text">请求后端数据</text>
                    </g>

                    <!-- 数据处理 -->
                    <g class="flow-node" data-step="process-data" onclick="highlightNode(this)">
                        <rect x="350" y="550" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="575" class="flow-text">数据处理</text>
                    </g>

                    <!-- 渲染表格 -->
                    <g class="flow-node" data-step="render-table" onclick="highlightNode(this)">
                        <rect x="500" y="500" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="550" y="525" class="flow-text">渲染表格</text>
                    </g>

                    <!-- 更新分页 -->
                    <g class="flow-node" data-step="update-pagination" onclick="highlightNode(this)">
                        <rect x="650" y="500" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="700" y="525" class="flow-text">更新分页</text>
                    </g>

                    <!-- 结束节点 -->
                    <g class="flow-node" data-step="query-end" onclick="highlightNode(this)">
                        <ellipse cx="800" cy="525" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="800" y="525" class="flow-text">查询完成</text>
                    </g>

                    <!-- 连接线 -->
                    <path class="flow-arrow" d="M100 110 L100 150"/>
                    <path class="flow-arrow" d="M100 200 L100 250"/>
                    <path class="flow-arrow" d="M150 275 L200 275"/>
                    <path class="flow-arrow" d="M100 300 L100 350"/>
                    <path class="flow-arrow" d="M150 375 L200 375"/>
                    <path class="flow-arrow" d="M250 400 L250 450"/>
                    <path class="flow-arrow" d="M300 475 L350 475"/>
                    <path class="flow-arrow" d="M250 500 L250 550"/>
                    <path class="flow-arrow" d="M300 575 L350 575"/>
                    <path class="flow-arrow" d="M450 525 L500 525"/>
                    <path class="flow-arrow" d="M600 525 L650 525"/>
                    <path class="flow-arrow" d="M750 525 L740 525"/>
                    
                    <!-- 缓存路径 -->
                    <path class="flow-arrow" d="M400 500 Q 450 475 500 500" stroke-dasharray="3,3"/>
                    
                    <!-- 返回循环线 -->
                    <path class="flow-arrow" d="M250 250 Q 320 200 100 200" stroke-dasharray="5,5"/>

                    <!-- 流程标签 -->
                    <text x="175" y="265" class="flow-label">条件错误</text>
                    <text x="75" y="315" class="flow-label">条件正确</text>
                    <text x="325" y="465" class="flow-label">有缓存</text>
                    <text x="225" y="515" class="flow-label">无缓存</text>
                </svg>

                <div class="flow-description">
                    <h3>🔍 活动查询流程说明</h3>
                    <p>该流程展示了用户查询活动列表的完整过程，包含条件验证、缓存检查、数据获取和界面渲染等步骤。</p>
                    <ol class="flow-steps">
                        <li><strong>输入查询条件：</strong>用户在查询表单中输入筛选条件</li>
                        <li><strong>条件验证：</strong>验证查询条件的格式和有效性</li>
                        <li><strong>构建查询参数：</strong>将用户输入转换为API查询参数</li>
                        <li><strong>检查缓存：</strong>优先检查本地是否有相同条件的缓存数据</li>
                        <li><strong>获取数据：</strong>从缓存或后端API获取活动数据</li>
                        <li><strong>数据处理：</strong>格式化和处理返回的数据</li>
                        <li><strong>界面渲染：</strong>更新表格和分页组件显示结果</li>
                    </ol>
                </div>
            </div>

            <!-- 活动管理流程 -->
            <div class="flow-content" id="manage-flow">
                <svg class="flow-svg" viewBox="0 0 1200 700">
                    <!-- 选择活动 -->
                    <g class="flow-node" data-step="select-activity" onclick="highlightNode(this)">
                        <ellipse cx="100" cy="80" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="100" y="80" class="flow-text">选择活动</text>
                    </g>

                    <!-- 操作类型判断 -->
                    <g class="flow-node" data-step="operation-type" onclick="highlightNode(this)">
                        <polygon points="100,150 150,175 100,200 50,175" class="decision-diamond node-rect"/>
                        <text x="100" y="175" class="flow-text">操作类型</text>
                    </g>

                    <!-- 查看详情 -->
                    <g class="flow-node" data-step="view-detail" onclick="highlightNode(this)">
                        <rect x="50" y="250" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="100" y="275" class="flow-text">查看详情</text>
                    </g>

                    <!-- 编辑活动 -->
                    <g class="flow-node" data-step="edit-activity" onclick="highlightNode(this)">
                        <rect x="200" y="250" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="275" class="flow-text">编辑活动</text>
                    </g>

                    <!-- 终止活动 -->
                    <g class="flow-node" data-step="terminate-activity" onclick="highlightNode(this)">
                        <rect x="350" y="250" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="275" class="flow-text">终止活动</text>
                    </g>

                    <!-- 状态检查 -->
                    <g class="flow-node" data-step="status-check" onclick="highlightNode(this)">
                        <polygon points="250,350 300,375 250,400 200,375" class="decision-diamond node-rect"/>
                        <text x="250" y="375" class="flow-text">状态检查</text>
                    </g>

                    <!-- 二次确认 -->
                    <g class="flow-node" data-step="confirm-dialog" onclick="highlightNode(this)">
                        <polygon points="400,350 450,375 400,400 350,375" class="decision-diamond node-rect"/>
                        <text x="400" y="375" class="flow-text">二次确认</text>
                    </g>

                    <!-- 状态错误 -->
                    <g class="flow-node" data-step="status-error" onclick="highlightNode(this)">
                        <rect x="150" y="450" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="200" y="475" class="flow-text">状态错误提示</text>
                    </g>

                    <!-- 取消操作 -->
                    <g class="flow-node" data-step="cancel-operation" onclick="highlightNode(this)">
                        <rect x="500" y="350" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="550" y="375" class="flow-text">取消操作</text>
                    </g>

                    <!-- 执行操作 -->
                    <g class="flow-node" data-step="execute-operation" onclick="highlightNode(this)">
                        <rect x="350" y="450" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="400" y="475" class="flow-text">执行操作</text>
                    </g>

                    <!-- 操作结果 -->
                    <g class="flow-node" data-step="operation-result" onclick="highlightNode(this)">
                        <polygon points="400,550 450,575 400,600 350,575" class="decision-diamond node-rect"/>
                        <text x="400" y="575" class="flow-text">操作结果</text>
                    </g>

                    <!-- 操作失败 -->
                    <g class="flow-node" data-step="operation-fail" onclick="highlightNode(this)">
                        <rect x="500" y="550" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="550" y="575" class="flow-text">操作失败提示</text>
                    </g>

                    <!-- 更新界面 -->
                    <g class="flow-node" data-step="update-ui" onclick="highlightNode(this)">
                        <rect x="350" y="650" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="675" class="flow-text">更新界面</text>
                    </g>

                    <!-- 结束节点 -->
                    <g class="flow-node" data-step="manage-end" onclick="highlightNode(this)">
                        <ellipse cx="650" cy="675" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="650" y="675" class="flow-text">操作完成</text>
                    </g>

                    <!-- 连接线 -->
                    <path class="flow-arrow" d="M100 110 L100 150"/>
                    <path class="flow-arrow" d="M75 200 L75 250" stroke-dasharray="3,3"/>
                    <path class="flow-arrow" d="M100 200 L250 250" stroke-dasharray="3,3"/>
                    <path class="flow-arrow" d="M125 200 L400 250" stroke-dasharray="3,3"/>
                    <path class="flow-arrow" d="M250 300 L250 350"/>
                    <path class="flow-arrow" d="M400 300 L400 350"/>
                    <path class="flow-arrow" d="M225 375 L175 450"/>
                    <path class="flow-arrow" d="M450 375 L500 375"/>
                    <path class="flow-arrow" d="M400 400 L400 450"/>
                    <path class="flow-arrow" d="M400 500 L400 550"/>
                    <path class="flow-arrow" d="M450 575 L500 575"/>
                    <path class="flow-arrow" d="M400 600 L400 650"/>
                    <path class="flow-arrow" d="M450 675 L590 675"/>

                    <!-- 流程标签 -->
                    <text x="60" y="225" class="flow-label">查看</text>
                    <text x="150" y="225" class="flow-label">编辑</text>
                    <text x="275" y="225" class="flow-label">终止</text>
                    <text x="175" y="415" class="flow-label">状态错误</text>
                    <text x="275" y="415" class="flow-label">状态正确</text>
                    <text x="475" y="365" class="flow-label">取消</text>
                    <text x="375" y="415" class="flow-label">确认</text>
                    <text x="475" y="565" class="flow-label">失败</text>
                    <text x="375" y="615" class="flow-label">成功</text>
                </svg>

                <div class="flow-description">
                    <h3>⚙️ 活动管理流程说明</h3>
                    <p>该流程展示了用户对活动进行各种管理操作的完整过程，包含查看、编辑、终止等操作的处理逻辑。</p>
                    <ol class="flow-steps">
                        <li><strong>选择活动：</strong>用户在列表中选择要操作的活动</li>
                        <li><strong>操作类型判断：</strong>根据用户点击的按钮确定操作类型</li>
                        <li><strong>状态检查：</strong>验证活动当前状态是否允许该操作</li>
                        <li><strong>二次确认：</strong>对于危险操作（如终止）进行确认</li>
                        <li><strong>执行操作：</strong>调用相应的API执行具体操作</li>
                        <li><strong>结果处理：</strong>根据操作结果更新界面或显示错误</li>
                        <li><strong>界面更新：</strong>刷新相关数据和状态显示</li>
                    </ol>
                </div>
            </div>

            <!-- 批量操作流程 -->
            <div class="flow-content" id="batch-flow">
                <svg class="flow-svg" viewBox="0 0 1200 600">
                    <!-- 选择多个活动 -->
                    <g class="flow-node" data-step="select-multiple" onclick="highlightNode(this)">
                        <ellipse cx="100" cy="80" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="100" y="80" class="flow-text">选择多个活动</text>
                    </g>

                    <!-- 选择数量检查 -->
                    <g class="flow-node" data-step="count-check" onclick="highlightNode(this)">
                        <polygon points="100,150 150,175 100,200 50,175" class="decision-diamond node-rect"/>
                        <text x="100" y="175" class="flow-text">数量检查</text>
                    </g>

                    <!-- 无选择提示 -->
                    <g class="flow-node" data-step="no-selection" onclick="highlightNode(this)">
                        <rect x="200" y="150" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="175" class="flow-text">无选择提示</text>
                    </g>

                    <!-- 批量操作类型 -->
                    <g class="flow-node" data-step="batch-type" onclick="highlightNode(this)">
                        <polygon points="100,250 150,275 100,300 50,275" class="decision-diamond node-rect"/>
                        <text x="100" y="275" class="flow-text">操作类型</text>
                    </g>

                    <!-- 批量导出 -->
                    <g class="flow-node" data-step="batch-export" onclick="highlightNode(this)">
                        <rect x="50" y="350" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="100" y="375" class="flow-text">批量导出</text>
                    </g>

                    <!-- 批量终止 -->
                    <g class="flow-node" data-step="batch-terminate" onclick="highlightNode(this)">
                        <rect x="200" y="350" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="250" y="375" class="flow-text">批量终止</text>
                    </g>

                    <!-- 状态验证 -->
                    <g class="flow-node" data-step="batch-validate" onclick="highlightNode(this)">
                        <polygon points="250,450 300,475 250,500 200,475" class="decision-diamond node-rect"/>
                        <text x="250" y="475" class="flow-text">状态验证</text>
                    </g>

                    <!-- 状态冲突 -->
                    <g class="flow-node" data-step="status-conflict" onclick="highlightNode(this)">
                        <rect x="350" y="450" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="475" class="flow-text">状态冲突提示</text>
                    </g>

                    <!-- 批量确认弹窗 -->
                    <g class="flow-node" data-step="batch-confirm" onclick="highlightNode(this)">
                        <polygon points="250,550 300,575 250,600 200,575" class="decision-diamond node-rect"/>
                        <text x="250" y="575" class="flow-text">批量确认</text>
                    </g>

                    <!-- 取消批量操作 -->
                    <g class="flow-node" data-step="cancel-batch" onclick="highlightNode(this)">
                        <rect x="350" y="550" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="400" y="575" class="flow-text">取消操作</text>
                    </g>

                    <!-- 执行批量操作 -->
                    <g class="flow-node" data-step="execute-batch" onclick="highlightNode(this)">
                        <rect x="500" y="475" width="100" height="50" rx="8" class="data-rect node-rect"/>
                        <text x="550" y="500" class="flow-text">执行批量操作</text>
                    </g>

                    <!-- 进度显示 -->
                    <g class="flow-node" data-step="show-progress" onclick="highlightNode(this)">
                        <rect x="650" y="475" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="700" y="500" class="flow-text">进度显示</text>
                    </g>

                    <!-- 操作完成 -->
                    <g class="flow-node" data-step="batch-complete" onclick="highlightNode(this)">
                        <rect x="800" y="475" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="850" y="500" class="flow-text">操作完成</text>
                    </g>

                    <!-- 结果统计 -->
                    <g class="flow-node" data-step="result-summary" onclick="highlightNode(this)">
                        <rect x="950" y="475" width="100" height="50" rx="8" class="process-rect node-rect"/>
                        <text x="1000" y="500" class="flow-text">结果统计</text>
                    </g>

                    <!-- 结束节点 -->
                    <g class="flow-node" data-step="batch-end" onclick="highlightNode(this)">
                        <ellipse cx="1100" cy="500" rx="60" ry="30" class="start-end-ellipse node-rect"/>
                        <text x="1100" y="500" class="flow-text">批量完成</text>
                    </g>

                    <!-- 连接线 -->
                    <path class="flow-arrow" d="M100 110 L100 150"/>
                    <path class="flow-arrow" d="M150 175 L200 175"/>
                    <path class="flow-arrow" d="M100 200 L100 250"/>
                    <path class="flow-arrow" d="M75 300 L75 350" stroke-dasharray="3,3"/>
                    <path class="flow-arrow" d="M125 300 L225 350" stroke-dasharray="3,3"/>
                    <path class="flow-arrow" d="M250 400 L250 450"/>
                    <path class="flow-arrow" d="M300 475 L350 475"/>
                    <path class="flow-arrow" d="M250 500 L250 550"/>
                    <path class="flow-arrow" d="M300 575 L350 575"/>
                    <path class="flow-arrow" d="M250 600 Q 375 625 550 525"/>
                    <path class="flow-arrow" d="M600 500 L650 500"/>
                    <path class="flow-arrow" d="M750 500 L800 500"/>
                    <path class="flow-arrow" d="M900 500 L950 500"/>
                    <path class="flow-arrow" d="M1050 500 L1040 500"/>
                    
                    <!-- 导出路径 -->
                    <path class="flow-arrow" d="M100 400 Q 300 425 550 475" stroke-dasharray="3,3"/>

                    <!-- 流程标签 -->
                    <text x="175" y="165" class="flow-label">无选择</text>
                    <text x="75" y="215" class="flow-label">有选择</text>
                    <text x="60" y="325" class="flow-label">导出</text>
                    <text x="160" y="325" class="flow-label">终止</text>
                    <text x="325" y="465" class="flow-label">冲突</text>
                    <text x="225" y="515" class="flow-label">通过</text>
                    <text x="325" y="565" class="flow-label">取消</text>
                    <text x="225" y="615" class="flow-label">确认</text>
                </svg>

                <div class="flow-description">
                    <h3>📦 批量操作流程说明</h3>
                    <p>该流程展示了用户进行批量操作的完整过程，包含选择验证、状态检查、确认机制和进度跟踪等功能。</p>
                    <ol class="flow-steps">
                        <li><strong>选择多个活动：</strong>用户通过复选框选择多个活动</li>
                        <li><strong>数量检查：</strong>验证是否有选中的活动</li>
                        <li><strong>操作类型判断：</strong>确定是导出还是终止操作</li>
                        <li><strong>状态验证：</strong>检查所选活动状态是否支持批量操作</li>
                        <li><strong>批量确认：</strong>显示确认弹窗，告知操作影响</li>
                        <li><strong>执行操作：</strong>按批次执行操作，显示进度</li>
                        <li><strong>结果统计：</strong>汇总操作结果，显示成功失败数量</li>
                    </ol>
                </div>
            </div>

            <!-- 图例说明 -->
            <div class="legend">
                <div class="legend-title">🎨 流程图图例</div>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="legend-shape start-end-ellipse"></div>
                        <span>开始/结束节点</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-shape process-rect"></div>
                        <span>处理过程</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-shape decision-diamond" style="clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);"></div>
                        <span>判断决策</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-shape data-rect"></div>
                        <span>数据操作</span>
                    </div>
                    <div class="legend-item">
                        <div style="width: 30px; height: 2px; background: #6c757d; margin-right: 10px;"></div>
                        <span>流程方向</span>
                    </div>
                    <div class="legend-item">
                        <div style="width: 30px; height: 2px; background: #6c757d; border-top: 2px dashed #6c757d; margin-right: 10px;"></div>
                        <span>条件分支</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 工具提示 -->
    <div class="tooltip" id="tooltip"></div>

    <script>
        let currentFlow = 'create';
        let animationTimer = null;
        let currentStep = 0;

        // 切换流程图
        function showFlow(flowType) {
            // 更新标签状态
            document.querySelectorAll('.flow-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // 显示对应流程
            document.querySelectorAll('.flow-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(flowType + '-flow').classList.add('active');

            currentFlow = flowType;
            resetFlow();
        }

        // 高亮节点
        function highlightNode(node) {
            // 重置所有节点
            document.querySelectorAll('.flow-node').forEach(n => {
                n.classList.remove('active');
            });
            document.querySelectorAll('.flow-arrow').forEach(arrow => {
                arrow.classList.remove('active');
            });

            // 高亮当前节点
            node.classList.add('active');

            // 高亮相关连接线
            const step = node.getAttribute('data-step');
            highlightRelatedArrows(step);

            // 显示工具提示
            showTooltip(node, step);
        }

        // 高亮相关箭头
        function highlightRelatedArrows(step) {
            document.querySelectorAll('.flow-arrow').forEach(arrow => {
                const from = arrow.getAttribute('data-from');
                const to = arrow.getAttribute('data-to');
                if (from === step || to === step) {
                    arrow.classList.add('active');
                }
            });
        }

        // 显示工具提示
        function showTooltip(node, step) {
            const tooltip = document.getElementById('tooltip');
            const stepDescriptions = {
                'start': '流程开始：用户发起操作',
                'login': '用户身份验证：确保用户已登录',
                'permission': '权限检查：验证用户操作权限',
                'no-permission': '权限不足：显示错误提示',
                'open-modal': '打开弹窗：显示操作界面',
                'fill-form': '填写表单：用户输入数据',
                'validate': '数据验证：检查输入有效性',
                'validate-fail': '验证失败：显示错误信息',
                'submit': '提交数据：发送到后端处理',
                'api-call': 'API调用：后端接口处理',
                'save-result': '保存结果：数据持久化',
                'save-fail': '保存失败：错误处理',
                'success': '操作成功：显示成功提示',
                'refresh': '刷新界面：更新数据显示',
                'end': '流程结束：操作完成'
            };

            const rect = node.getBoundingClientRect();
            tooltip.textContent = stepDescriptions[step] || '流程节点';
            tooltip.style.left = rect.left + rect.width / 2 - tooltip.offsetWidth / 2 + 'px';
            tooltip.style.top = rect.top - 40 + 'px';
            tooltip.classList.add('show');

            // 3秒后隐藏
            setTimeout(() => {
                tooltip.classList.remove('show');
            }, 3000);
        }

        // 演示流程动画
        function animateFlow() {
            resetFlow();
            
            const flowSteps = {
                'create': ['start', 'login', 'permission', 'open-modal', 'fill-form', 'validate', 'submit', 'api-call', 'save-result', 'success', 'refresh', 'end'],
                'query': ['query-start', 'input-conditions', 'condition-validate', 'build-params', 'send-request', 'check-cache', 'fetch-data', 'process-data', 'render-table', 'update-pagination', 'query-end'],
                'manage': ['select-activity', 'operation-type', 'edit-activity', 'status-check', 'confirm-dialog', 'execute-operation', 'operation-result', 'update-ui', 'manage-end'],
                'batch': ['select-multiple', 'count-check', 'batch-type', 'batch-terminate', 'batch-validate', 'batch-confirm', 'execute-batch', 'show-progress', 'batch-complete', 'result-summary', 'batch-end']
            };

            const steps = flowSteps[currentFlow] || [];
            currentStep = 0;

            animationTimer = setInterval(() => {
                if (currentStep < steps.length) {
                    const stepNode = document.querySelector(`[data-step="${steps[currentStep]}"]`);
                    if (stepNode) {
                        highlightNode(stepNode);
                    }
                    currentStep++;
                } else {
                    clearInterval(animationTimer);
                }
            }, 1500);
        }

        // 重置流程状态
        function resetFlow() {
            if (animationTimer) {
                clearInterval(animationTimer);
            }
            
            document.querySelectorAll('.flow-node').forEach(node => {
                node.classList.remove('active');
            });
            document.querySelectorAll('.flow-arrow').forEach(arrow => {
                arrow.classList.remove('active');
            });
            document.getElementById('tooltip').classList.remove('show');
        }

        // 高亮关键路径
        function highlightCriticalPath() {
            resetFlow();
            
            const criticalPaths = {
                'create': ['start', 'login', 'permission', 'open-modal', 'fill-form', 'validate', 'submit', 'api-call', 'save-result', 'success'],
                'query': ['query-start', 'input-conditions', 'condition-validate', 'build-params', 'send-request', 'fetch-data', 'render-table'],
                'manage': ['select-activity', 'operation-type', 'status-check', 'confirm-dialog', 'execute-operation', 'update-ui'],
                'batch': ['select-multiple', 'count-check', 'batch-validate', 'batch-confirm', 'execute-batch', 'result-summary']
            };

            const path = criticalPaths[currentFlow] || [];
            path.forEach((step, index) => {
                setTimeout(() => {
                    const stepNode = document.querySelector(`[data-step="${step}"]`);
                    if (stepNode) {
                        highlightNode(stepNode);
                    }
                }, index * 800);
            });
        }

        // 鼠标移出隐藏工具提示
        document.addEventListener('mousemove', (e) => {
            const tooltip = document.getElementById('tooltip');
            if (!e.target.closest('.flow-node')) {
                setTimeout(() => {
                    tooltip.classList.remove('show');
                }, 1000);
            }
        });

        // 键盘快捷键支持
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case '1':
                    showFlow('create');
                    break;
                case '2':
                    showFlow('query');
                    break;
                case '3':
                    showFlow('manage');
                    break;
                case '4':
                    showFlow('batch');
                    break;
                case ' ':
                    e.preventDefault();
                    animateFlow();
                    break;
                case 'Escape':
                    resetFlow();
                    break;
            }
        });

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            console.log('微信活动管理系统流程图已加载');
        });
    </script>
</body>
</html>