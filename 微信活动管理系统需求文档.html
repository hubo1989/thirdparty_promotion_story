<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>微信活动管理系统需求文档</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ECharts图表支持 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <!-- 代码高亮 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <style>
        :root {
            --primary-color: #409EFF;
            --text-color: #333;
            --bg-color: #f5f7fa;
        }
        
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            background: #1a73e8;
            color: white;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .toc {
            width: 200px;
            position: sticky;
            top: 2rem;
            height: calc(100vh - 4rem);
            overflow-y: auto;
        }
        
        .content {
            flex: 1;
            padding: 0 2rem;
        }
        
        section {
            margin-bottom: 3rem;
            scroll-margin-top: 6rem;
        }
        
        h1, h2, h3 {
            color: #1a73e8;
            margin-top: 2rem;
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.25em 0.6em;
            border-radius: 4px;
            font-size: 0.9em;
        }
        
        .status-draft { background: #e6e6e6; }
        .status-pending { background: #a5d8ff; }
        .status-active { background: #4ecdc4; }
        .status-ended { background: #dcdcdc; }
        .status-terminated { background: #ff8080; }
        
        .code-block {
            background: #f8f8f8;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 0.75rem;
            vertical-align: top;
        }
        
        th {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>微信活动管理系统需求文档</h1>
            <p class="version">文档版本：v1.1 | 最后更新：2025-07-30</p>
        </div>
    </header>

    <div class="container" style="display: flex; gap: 2rem;">
        <div class="toc">
            <h3>目录</h3>
            <ul>
                <li><a href="#doc-info">1. 文档信息</a></li>
                <li><a href="#project-bg">2. 项目背景</a></li>
                <li><a href="#func-req">3. 功能需求</a></li>
                <li><a href="#ui-design">4. 界面设计</a></li>
                <li><a href="#data-spec">5. 数据规范</a></li>
                <li><a href="#non-func">6. 非功能需求</a></li>
                <li><a href="#perm-design">7. 权限设计</a></li>
                <li><a href="#appendix">8. 附录</a></li>
            </ul>
        </div>

        <div class="content">
            <!-- 1. 文档信息 -->
            <section id="doc-info">
                <h2>1. 文档信息</h2>
                <table>
                    <tr><th>属性</th><th>内容</th></tr>
                    <tr><td>文档名称</td><td>微信活动管理系统需求文档</td></tr>
                    <tr><td>编写人</td><td>呼博</td></tr>
                </table>
            </section>

            <!-- 2. 项目背景 -->
            <section id="project-bg">
                <h2>2. 项目背景</h2>
                <p>本功能针对第三方微信活动管理，支持银行等金融机构开展线上营销活动。主要目标包括：</p>
                <ul>
                    <li>多渠道通用（通过标签区分）</li>
                    <li>强化权限管理（按角色控制）</li>
                    <li>实现全流程可视化（支持多维度数据分析）</li>
                </ul>
            </section>

            <!-- 3. 功能需求 -->
            <section id="func-req">
                <h2>3. 功能需求</h2>
                
                <h3>3.1 核心功能模块</h3>
                <table>
                    <tr><th>模块</th><th>功能描述</th><th>业务规则</th></tr>
                    <tr>
                        <td>活动管理</td>
                        <td>创建/编辑/终止活动</td>
                        <td>支持多种活动类型（满减、打折等）</td>
                    </tr>
                    <tr>
                        <td>数据统计</td>
                        <td>查看活动数据</td>
                        <td>支持查看领券及核销明细</td>
                    </tr>
                </table>

                <h3>3.2 活动状态管理</h3>
                <div id="activity-status-chart" style="width: 100%; height: 400px;"></div>
                <script>
                    function initActivityStatusChart() {
                        var chartDom = document.getElementById('activity-status-chart');
                        if (chartDom && typeof echarts !== 'undefined') {
                            var myChart = echarts.init(chartDom);
                            
                            myChart.setOption({
                                title: {
                                    text: '活动状态流转图'
                                },
                                series: [{
                                    type: 'graph',
                                    layout: 'force',
                                    symbolSize: 50,
                                    roam: false, // 禁用缩放和漫游
                                    focusNodeAdjacency: true,
                                    draggable: false, // 禁用节点拖拽
                                    force: {
                                        repulsion: 1000,
                                        edgeLength: [50, 100]
                                    },
                                    label: {
                                        show: true
                                    },
                                    edgeSymbol: ['circle', 'arrow'],
                                    edgeSymbolSize: [4, 10],
                                    data: [{
                                        name: '待开始',
                                        itemStyle: { color: '#66CCFF' }
                                    }, {
                                        name: '进行中',
                                        itemStyle: { color: '#66FF66' }
                                    }, {
                                        name: '已终止',
                                        itemStyle: { color: '#FF6666' }
                                    }, {
                                        name: '已结束',
                                        itemStyle: { color: '#CCCCCC' }
                                    }],
                                    links: [{
                                        source: '待开始',
                                        target: '进行中'
                                    }, {
                                        source: '进行中',
                                        target: '已终止',
                                        lineStyle: { width: 2 },
                                        label: { show: true, formatter: '手动终止' }
                                    }, {
                                        source: '进行中',
                                        target: '已结束',
                                        lineStyle: { width: 2 },
                                        label: { show: true, formatter: '时间到达' }
                                    }],
                                    lineStyle: {
                                        opacity: 0.9,
                                        width: 2,
                                        curveness: 0
                                    }
                                }]
                            });
                        }
                    }
                    
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', initActivityStatusChart);
                    } else {
                        initActivityStatusChart();
                    }
                </script>

                <!-- 
                    操作权限控制表
                    描述了不同用户角色对活动管理功能的访问权限
                    权限基于控制台用户角色可配置
                -->
                <h3>3.3 操作权限控制</h3>
                <!-- 
                    权限矩阵表
                    展示了管理员、操作员和审计员三种角色对系统功能的访问权限
                    ✓ 表示有权限，✗ 表示无权限
                    权限控制基于控制台用户角色配置，支持灵活调整
                -->
                <table>
                    <tr><th>角色</th><th>查看</th><th>创建</th><th>编辑</th><th>终止</th></tr>
                    <tr>
                        <td>管理员</td>
                        <td>✓</td>
                        <td>✓</td>
                        <td>✓</td>
                        <td>✓</td>
                    </tr>
                    <tr>
                        <td>操作员</td>
                        <td>✓</td>
                        <td>✓</td>
                        <td>✓</td>
                        <td>✗</td>
                    </tr>
                    <tr>
                        <td>审计员</td>
                        <td>✓</td>
                        <td>✗</td>
                        <td>✗</td>
                        <td>✗</td>
                    </tr>
                </table>
            </section>

            <!-- 4. 界面设计 -->
            <section id="ui-design">
                <h2>4. 界面设计</h2>
                
                <h3>4.1 系统架构图</h3>
                <div id="system-architecture-chart" style="width: 100%; height: 600px;"></div>
                <script>
                    function initSystemArchitectureChart() {
                        var chartDom = document.getElementById('system-architecture-chart');
                        if (chartDom && typeof echarts !== 'undefined') {
                            var myChart = echarts.init(chartDom);
                            
                            myChart.setOption({
                                title: {
                                    text: '系统架构图'
                                },
                                series: [{
                                    type: 'graph',
                                    layout: 'force',
                                    symbolSize: 60,
                                    roam: false, // 禁用缩放和漫游
                                    focusNodeAdjacency: true,
                                    draggable: false, // 禁用节点拖拽
                                    force: {
                                        repulsion: 1500,
                                        edgeLength: [100, 200]
                                    },
                                    label: {
                                        show: true
                                    },
                                    edgeSymbol: ['circle', 'arrow'],
                                    edgeSymbolSize: [4, 10],
                                    data: [{
                                        name: '前端',
                                        itemStyle: { color: '#66CCFF' }
                                    }, {
                                        name: 'API网关',
                                        itemStyle: { color: '#FF9966' }
                                    }, {
                                        name: '活动管理服务',
                                        itemStyle: { color: '#66FF66' }
                                    }, {
                                        name: '权限服务',
                                        itemStyle: { color: '#66FF66' }
                                    }, {
                                        name: '数据服务',
                                        itemStyle: { color: '#66FF66' }
                                    }, {
                                        name: 'MySQL',
                                        itemStyle: { color: '#CCCCCC' }
                                    }, {
                                        name: 'Redis',
                                        itemStyle: { color: '#CCCCCC' }
                                    }],
                                    links: [{
                                        source: '前端',
                                        target: 'API网关'
                                    }, {
                                        source: 'API网关',
                                        target: '活动管理服务'
                                    }, {
                                        source: 'API网关',
                                        target: '权限服务'
                                    }, {
                                        source: 'API网关',
                                        target: '数据服务'
                                    }, {
                                        source: '活动管理服务',
                                        target: 'MySQL'
                                    }, {
                                        source: '权限服务',
                                        target: 'MySQL'
                                    }, {
                                        source: '数据服务',
                                        target: 'MySQL'
                                    }, {
                                        source: '活动管理服务',
                                        target: 'Redis'
                                    }],
                                    lineStyle: {
                                        opacity: 0.9,
                                        width: 2,
                                        curveness: 0
                                    }
                                }]
                            });
                        }
                    }
                    
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', initSystemArchitectureChart);
                    } else {
                        initSystemArchitectureChart();
                    }
                </script>

                <h3>4.2 操作流程图</h3>
                <div id="operation-flow-chart" style="width: 100%; height: 400px;"></div>
                <script>
                    function initOperationFlowChart() {
                        var chartDom = document.getElementById('operation-flow-chart');
                        if (chartDom && typeof echarts !== 'undefined') {
                            var myChart = echarts.init(chartDom);
                            
                            myChart.setOption({
                                title: {
                                    text: '操作流程图'
                                },
                                series: [{
                                    type: 'graph',
                                    layout: 'force',
                                    symbolSize: 60,
                                    roam: false, // 禁用缩放和漫游
                                    focusNodeAdjacency: true,
                                    draggable: false, // 禁用节点拖拽
                                    force: {
                                        repulsion: 1000,
                                        edgeLength: [50, 100]
                                    },
                                    label: {
                                        show: true
                                    },
                                    edgeSymbol: ['circle', 'arrow'],
                                    edgeSymbolSize: [4, 10],
                                    data: [{
                                        name: '创建活动',
                                        itemStyle: { color: '#66CCFF' }
                                    }, {
                                        name: '待生效',
                                        itemStyle: { color: '#FF9966' }
                                    }, {
                                        name: '编辑活动',
                                        itemStyle: { color: '#FF9966' }
                                    }, {
                                        name: '生效中',
                                        itemStyle: { color: '#66FF66' }
                                    }, {
                                        name: '已终止',
                                        itemStyle: { color: '#CCCCCC' }
                                    }],
                                    links: [{
                                        source: '创建活动',
                                        target: '待生效'
                                    }, {
                                        source: '待生效',
                                        target: '生效中'
                                    }, {
                                        source: '生效中',
                                        target: '编辑活动'
                                    }, {
                                        source: '编辑活动',
                                        target: '待生效'
                                    }, {
                                        source: '生效中',
                                        target: '已终止',
                                        lineStyle: { width: 2 },
                                        label: { show: true, formatter: '手动终止' }
                                    }],
                                    lineStyle: {
                                        opacity: 0.9,
                                        width: 2,
                                        curveness: 0
                                    }
                                }]
                            });
                        }
                    }
                    
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', initOperationFlowChart);
                    } else {
                        initOperationFlowChart();
                    }
                </script>
                
            </section>

            <!-- 5. 数据规范 -->
            <section id="data-spec">
                <h2>5. 数据规范</h2>
                
                <h3>5.1 数据字典</h3>
                <table>
                    <tr><th>字段</th><th>类型</th><th>描述</th><th>约束</th></tr>
                    <tr>
                        <td>activityId</td>
                        <td>string</td>
                        <td>活动唯一标识</td>
                        <td>32位UUID</td>
                    </tr>
                    <tr>
                        <td>effectiveTime</td>
                        <td>datetime</td>
                        <td>生效时间</td>
                        <td>未来6个月内</td>
                    </tr>
                </table>

                <h3>5.2 时间规范</h3>
                <ul>
                    <li>时间格式：ISO 8601（YYYY-MM-DDTHH:mm:ssZ）</li>
                    <li>时区：UTC+8</li>
                    <li>时间精度：秒级</li>
                </ul>
            </section>

            <!-- 6. 非功能需求 -->
            <section id="non-func">
                <h2>6. 非功能需求</h2>
                
                <h3>6.1 性能指标</h3>
                <table>
                    <tr><th>指标</th><th>要求</th></tr>
                    <tr><td>并发处理</td><td>≥1000 TPS</td></tr>
                    <tr><td>响应时间</td><td>≤500ms（P95）</td></tr>
                </table>

                <h3>6.2 安全要求</h3>
                <ul>
                    <li>敏感数据加密存储（AES-256）</li>
                    <li>操作日志保留36个月</li>
                    <li>权限粒度控制到字段级别</li>
                </ul>
            </section>

            <!-- 7. 权限设计 -->
            <section id="perm-design">
                <h2>7. 权限设计</h2>
                
                <h3>7.1 权限矩阵</h3>
                <table>
                    <tr><th>操作</th><th>管理员</th><th>操作员</th><th>审计员</th></tr>
                    <tr>
                        <td>创建活动</td>
                        <td>✓</td>
                        <td>✓</td>
                        <td>✗</td>
                    </tr>
                </table>
            </section>

            <!-- 8. 附录 -->
            <section id="appendix">
                <h2>8. 附录</h2>
                
                <h3>8.1 术语表</h3>
                <table>
                    <tr><th>术语</th><th>说明</th></tr>
                    <tr><td>TPS</td><td>每秒事务处理量</td></tr>
                    <tr><td>P95</td><td>95分位响应时间</td></tr>
                </table>

                <h3>8.2 版本变更记录</h3>
                <table>
                    <tr><th>版本</th><th>变更内容</th><th>日期</th></tr>
                    <tr><td>v1.0</td><td>初始版本</td><td>2024-03-15</td></tr>
                    <tr><td>v1.1</td><td>补充安全规范</td><td>2024-03-20</td></tr>
                </table>
            </section>
        </div>
    </div>

    <script>hljs.highlightAll();</script>
</body>
</html>